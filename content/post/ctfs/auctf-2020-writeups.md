---
title: "Auburn University: AUCTF 2020"
excerpt: "Writeups for various challenges I solved during the 2020 AUCTF capture the flag competition."
date: 2020-04-03T09:24:19-05:00
url: "/ctfs/2020/auctf-writeups"
categories:
 - capture the flag writeups
tags:
 - ctfs
---

# Auburn University: AUCTF 2020

| Forensics | Password Cracking | Crypto | Trivia | Bash | Web | Signals | Reversing | OSINT | Sequence |
|-----------|-------------------|--------|--------|------|-----|---------|-----------|-------|----------|
| [Fahrenheit 451](#fahrenheit-451) | [Crack Me](#crack-me) | [Pretty Ridiculous](#pretty-ridiculous) | | [BASH 1](#bash-1) | [Miyazaki Trivia](#miyazaki-trivia) | [FCC Hunter](#fcc-hunter) | [Sora](#sora) | [Who Made Me](#who-made-me) | [Prime Rib](#prime-rib) |
| [Har Har Har](#har-har-har) |  [Salty](#salty) | [Land Locked](#land-locked) | | [BASH 2](#bash-2) | | | [Mr. Game and Watch](#mr-game-and-watch) | | |
| | [Zippy](#zippy) | [I'll Have The Salad](#ill-have-the-salad) | | [BASH 3](#bash-3) | | | [Cracker Barrel](#cracker-barrel) | | |
| | | | | [BASH 4](#bash-4) | | | [mobile0](#mobile0) | | |
| | | | | | | | [mobile1](#mobile1) | | |

# Forensics
## Fahrenheit 451
> Your SUBSTITUTE teacher accessed his copy of Fahrenheit 451 over his windows network share. Can you find the flag your friend hid in the book?
>
> Standard Flag Format auctf{}
>
> Author: vincent

We can examine the given PCAP file in wireshark. We see what looks to be transmission of the book's PDF. We can extract the PDF object:

&nbsp;
{{< image src="/img/auctf/f451_objdump.png" alt="f451_objdump.png" position="center" style="border-radius: 8px;" >}}
&nbsp;
&nbsp;
{{< image src="/img/auctf/f451_pdf.png" alt="f451_pdf.png" position="center" style="border-radius: 8px;" >}}
&nbsp;

This give's us a standard PDF to open and inspect. `strings` didn't reveal anything obvious. Searching for `auct` didn't yield any results either. Skimming through the PDF, there didn't appear to be any weird text/strings, with the exception of _stolid_ being underlined. They had to have hidden the flag _somewhere_ in the file, so I started highlighting things to see if something might have been whited-out. Sure enough, we see some "hidden" text around page 8:

&nbsp;
{{< image src="/img/auctf/f451_hidden.png" alt="f451_hidden.png" position="center" style="border-radius: 8px;" >}}
&nbsp;

If we just highlight and copy/paste this chunk, we get:

```bash
2F4E7L3FC?0E9603@@<DPP`PN
```

The challenge hint suggests this might be a substitution cipher (`SUBSTITUTE teacher...`). [Using this online page to decihper it, using ROT47](https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php), we get the flag.

Flag is `auctf{burn_the_books!!1!}`

## Har Har Har

> Someone found this .har file. Can you see what's in it?
>
> Standard Flag Format auctf{}
>
> Author: vincent
> dev.quickbrownfoxes.org_Archive_19-12-01_15-41-53.har

```js
"log": {
    "version": "1.2",
    "creator": {
      "name": "Firefox",
      "version": "70.0.1"
    },
    "browser": {
      "name": "Firefox",
      "version": "70.0.1"
    },
    "pages": [
      {
        "startedDateTime": "2019-12-01T15:41:39.691-06:00",
        "id": "page_1",
        "pageTimings": {
          "onContentLoad": 37,
          "onLoad": 259
        }
      }
    ],
    "entries": [
      {
        "pageref": "page_1",
        "startedDateTime": "2019-12-01T15:41:39.691-06:00",
        "request": {
          "bodySize": 0,
          "method": "GET",
          "url": "https://dev.quickbrownfoxes.org/dev/auctf/87502894-194871-9-183-18038928741924721.png",
          "httpVersion": "HTTP/2.0",
...
          "cookies": [],
          "content": {
            "mimeType": "image/png",
            "size": 15933,
            "encoding": "base64",
            "text": "iVBORw0KG....",
...
```

So, we can tell that text is base64 encoded. If we decode it, we get what looks to be a PNG image to the console.

```bash
cat dev.quickbrownfoxes.org_Archive_19-12-01_15-41-53.har  | jq -r '.log.entries[] | .response.content.text' | base64 -d > out.png
```

And then if we examine that photo:

&nbsp;
{{< image src="/img/auctf/harhar/out.png" alt="out.png" position="center" style="border-radius: 8px;" >}}
&nbsp;

Flag is `auctf{harhar34}`.

# Password Cracking
## Crack Me
> Here's an easy one.
>
> Hash: `33f966f258879f252d582d45cef37e5e`
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> Author: OG_Commando

Analyzing the given hash using [Cyberchef](https://gchq.github.io/CyberChef/) we can see that it looks most likely to be an MD5 hash:

```bash
Hash length: 32
Byte length: 16
Bit length:  128

Based on the length, this hash could have been generated by one of the following hashing functions:
MD5
MD4
MD2
HAVAL-128
RIPEMD-128
Snefru
Tiger-128
```

Using John The Ripper, we can generate a fake password file:

```bash
fakeusername:33f966f258879f252d582d45cef37e5e
```

And then use John with a raw md5 format option, and let it brute force it:

```bash
Using default input encoding: UTF-8
Loaded 1 password hash (Raw-MD5 [MD5 128/128 SSE2 4x3])
Press 'q' or Ctrl-C to abort, almost any other key for status
0g 0:00:02:01  3/3 0g/s 22935Kp/s 22935Kc/s 22935KC/s 8a0xvu..8a0x6j
0g 0:00:02:10  3/3 0g/s 23222Kp/s 23222Kc/s 23222KC/s pusioth18..pusiohesh
0g 0:00:07:08  3/3 0g/s 25406Kp/s 25406Kc/s 25406KC/s buki9_x..buka670
0g 0:00:22:39  3/3 0g/s 25111Kp/s 25111Kc/s 25111KC/s omo-wgs..omo-w9a
0g 0:00:28:45  3/3 0g/s 25823Kp/s 25823Kc/s 25823KC/s rmmfphjr..rmmfppar
0g 0:00:54:19  3/3 0g/s 26742Kp/s 26742Kc/s 26742KC/s edih1tel..edih1t05
0g 0:01:13:45  3/3 0g/s 26355Kp/s 26355Kc/s 26355KC/s mcaujb14a..mcaujb1lv
bad4ever         (fakeuser)
1g 0:01:26:32 DONE 3/3 (2020-04-03 12:44) 0.000192g/s 26436Kp/s 26436Kc/s 26436KC/s banvjgz!..bad4evi1
Use the "--show" option to display all of the cracked passwords reliably
Session completed
```

Flag is `bad4ever`.

## Salty
> You might need this: 1337
>
> Hash: 5eaff45e09bec5222a9cfa9502a4740d
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> Author: OG_Commando

We're given what looks to be another MD5 hash; and what we can assume to be a salt (based on the challenge name). A bit of Googling lead me to [this page about cracking salted MD5 hashes with hashcat](https://robinverton.de/blog/2012/07/15/cracking-salted-md5-with-hashcat/).

I downloaded hashcat with `brew install hashcat`, and grabbed a copy of the [rockyou.txt](https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt) set of most commonly used bad passwords.

I first tried the same format as that webpage, i.e. `md5(hash.salt)`. That did not yield any results. However, using `-m 20` (i.e. `md5(salt.hash)`), generated a result _very_ fast:

```bash
cat ./pwd
5eaff45e09bec5222a9cfa9502a4740d:1337


hashcat -m 20 -a 0 ./pwd ./rockyou.txt
hashcat (v5.1.0-1772-g3c1ddc81) starting...

* Device #1: Intel(R) Core(TM) i7-4650U CPU @ 1.70GHz, skipped
* Device #2: HD Graphics 5000, 1472/1536 MB (384 MB allocatable), 40MCU

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256
Minimim salt length supported by kernel: 0
Maximum salt length supported by kernel: 256

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Applicable optimizers:
* Zero-Byte
* Early-Skip
* Not-Iterated
* Single-Hash
* Single-Salt
* Raw-Hash

ATTENTION! Pure (unoptimized) backend kernels selected.
Using pure kernels enables cracking longer passwords but for the price of drastically reduced performance.
If you want to switch to optimized backend kernels, append -O to your commandline.
See the above message to find out about the exact limits.

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.

Host memory required for this attack: 409 MB

Dictionary cache hit:
* Filename..: .../rockyou.txt
* Passwords.: 14344384
* Bytes.....: 139921497
* Keyspace..: 14344384

5eaff45e09bec5222a9cfa9502a4740d:1337:treetop

Session..........: hashcat
Status...........: Cracked
Hash.Name........: md5($salt.$pass)
Hash.Target......: 5eaff45e09bec5222a9cfa9502a4740d:1337
Time.Started.....: Sat Apr  4 13:02:23 2020 (0 secs)
Time.Estimated...: Sat Apr  4 13:02:23 2020 (0 secs)
Guess.Base.......: File (.../rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#2.........:  4954.0 kH/s (6.57ms) @ Accel:32 Loops:1 Thr:64 Vec:1
Recovered........: 1/1 (100.00%) Digests
Progress.........: 81920/14344384 (0.57%)
Rejected.........: 0/81920 (0.00%)
Restore.Point....: 0/14344384 (0.00%)
Restore.Sub.#2...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#2....: 123456 -> janmark

Started: Sat Apr  4 13:01:25 2020
Stopped: Sat Apr  4 13:02:24 2020
```

Boom - it got our flag!

```bash
5eaff45e09bec5222a9cfa9502a4740d:1337:treetop
```

Flag is `treetop`.

## Zippy
> Have fun!
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> Author: OG_Commando

First, we get the hashed password out of the zip file using `zip2john`:

```bash
./run/zip2john ../zippy.zip | cut -d':' -f 2 > ../zippy.hashcat.hashes
```

Then, we use hashcat to crack the hash:
```bash
hashcat -a 0 -m 13600 ../zippy.hashcat.hashes rockyou.txt
```

Which, eventually it does:

```bash
...

$zip2$*0*1*0*c08d7c0b232de6b3*f4fd*353*0cf6d3cf3ecc646b5ecf1a50f2396eef083c29c6b7105f62440c1a1ecfd39a7fd50c2a887474c6119ea929c314ddc4a018d8f0c516219afdef7090a09f1487a070d6f5b2553ae1ec8d89a745e3efdadc92db5dfe435596887e5d56940946a1d5eb8be18f3bc641c9475355662e165478521c4567aebaae583998dc344d67b3cfecf4a242da1d0f100b6bb5b900d282efca55009195f5aae415fc115ccca49e75af7a70cf5ffd0d701fa58e2b10a47b0cd78d48f8f1e542bfb1d29a77b7670ad811440bda01ddb292bbc5777fe62b351234c0c881d03f18e6cc305e8a223983fbc10974e4bcdbceb76025b86991a14bb05db83f9e38e52e23c59095f43f3fa1916324a6882817c6edd5e696eceb20c0dd298f62d704549e1afaaeb6ce5ced3b794c4287d1c0fe1ccb9ce4c91aaeeb9f17ad2f9d0cce2fd23d0a7c2e77e29ab85db596c5467f234197fe7aaaece4946e313bad20d9df0d87664bea649e84dd1c5050795f203c545d6e4c834406938fd9733d97522cb2c761b23ab0cd36657f8f1dfa39ce8bf56d19386838c596690e78a31672752fbdeee675dab6d5216e1619e39a3a6597444ce276385c083107caab85d4ef1970aba59c623cf1b0fdc93b714edb23ce011ac7ae639cb3edb69c7375f9c47369b02936ab9effd892237f1557f4d33c256dfa641dc194ad1c070c35f5382ea2349d340c2b7c335cff279f815c953594e1be14f58b30a3543b46862b95cf02de1265d53cdafcefb0b091712988c646ff01837272b62fcaed7e47f98393e8d1e62b93086b74583b86d6df41d47524affb9d22be09d4499a99171aee09714bddb06a29fad6ab28b85865f3ca8f5df2763395587c6a6e377e8f7f92d40dd9063ad628832664f4f1ba3a358ee8d870358d4ea846b7b9dfa5d63b6add2b097b3e0a4f1701ad57c4f7a2f501da799f6a9bf205f79367804642638ec34eb35568e7e82bb85666dc84a3e2abbe5f52409b33d3edc9544d0dda0d888852ecdc9dd256793ff4e1ac95777c58ab11c292f0d38befd2917144d18949d69d7e94fbe98e1ca6dc48923f962b5f34269030447dba6c2127bdfa94bc2b71f046c6c13aa1b8331c3ba23245f2696209c55e15f9d8cecfc6b447d19eb5b10b237608683f008994b11363d01395f35fa7845562325d5c51080e2c2396c6fa1dcecc5e9edf17475c78f308*7129395cf8dd47ce280f*$/zip2$:8297018229

Session..........: hashcat
Status...........: Cracked
Hash.Name........: WinZip
Hash.Target......: $zip2$*0*1*0*c08d7c0b232de6b3*f4fd*353*0cf6d3cf3ecc.../zip2$
Time.Started.....: Sat Apr  4 14:16:41 2020 (5 mins, 2 secs)
Time.Estimated...: Sat Apr  4 14:21:43 2020 (0 secs)
Guess.Base.......: File (rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#2.........:    39124 H/s (465.96ms) @ Accel:1 Loops:999 Thr:512 Vec:1
Recovered........: 1/1 (100.00%) Digests
Progress.........: 11796480/14344384 (82.24%)
Rejected.........: 0/11796480 (0.00%)
Restore.Point....: 11776000/14344384 (82.09%)
Restore.Sub.#2...: Salt:0 Amplifier:0-1 Iteration:0-999
Candidates.#2....: 8370670 -> 8205357

Started: Sat Apr  4 14:16:20 2020
Stopped: Sat Apr  4 14:21:44 2020
```

So, the first .zip has password `8297018229`. We can use that to unlock it, which gives us another .zip: `unzipme.zip`. Repeating the above process, we see:

```bash
...
$zip2$*0*1*0*34905e0be29aed9f*2d1d*2be*d21995d8b02399519a53aadfcbd34c1382543742007381aed1be67373da8c8daad26fc932ccbb30b7345b161d9405cbf9594d9bdbb325ef06adda7aaff9bd54e24c90b76b424810c309bed577133dc0d9dcfbf55fe95fb864e93bd256b8595a07dabc21bfbe4c9b3667635eb880cc5c27d386b46a01604af02e904fc3c6f7b62770b49408a06baee061db31862dc6546576b942075cae21c8e584c3f36cdc2a9ba0133ea9395a732ef2122941122187099e0e86ed9ffda0f81ff70b92a46eb674d2249c37df599cd81f5c2618963964f5c4edd7cba5b701ed592f62e8ddf04ef10e27c215abe12da12a3568837d81a42c14fd5c81a0e2d3fd9606001ec0416e1f4386ce87b94e7a6f2b53d32de0b94b3b625839269901dcb66333da8835e0c2bcdf616bc87fc9133174b637c2399eabcea96d069ade3f974fdb46338ea1b3e9510a9da18f672cb5a317f847879f945358df4c947e5793e57d05d72eb6cfcbd981830ac06dd831f3d6787b4eb73fde2d7a11e00cb6b9306c613c3a937f8a33db641014ed3517e6ae1c7e5c3976cdb8d72117b1babb9baad125c7aa445e9673b988b1e1ca647da61b5a989213b13d26df8453d0fd46ef1ec1a385a166ed750f75d194c04ee7fe3ad0e40e81f6f7e2c9f85fb76860763162ab9e98bda7d111c0b82a3ce286e70ee14b243f9c486b6d5064ae10f3afd201fbd42ee860a3f82ae94a60025944e8e1bea84add763a22edcfd3498304674ae826f023f20442e5acc06dfbe3e1a8617bac5b3e36bdc83a736b0a58b7145998011d987a0ecaf5a2e60db78cf3c89bf56563d2ec37969e183efaae6a468d04327bf42a2b1e304ea66bc78eccb6c16e7e3b328cbdbde7f736b67c907cd05be0969fc7b53ef70fb654f969819bec3991eaa6889dc7e1c88294fdf1d23467e6e09ce6fa9ddc3c5f21b7a2cd79fac045fae721640d244e045158a836d69de914ea769cbf2927576a285a35c*3d1eab46d20220335353*$/zip2$:pugh1948

Session..........: hashcat
Status...........: Cracked
Hash.Name........: WinZip
Hash.Target......: $zip2$*0*1*0*34905e0be29aed9f*2d1d*2be*d21995d8b023.../zip2$
Time.Started.....: Sat Apr  4 14:47:09 2020 (1 min, 56 secs)
Time.Estimated...: Sat Apr  4 14:49:05 2020 (0 secs)
Guess.Base.......: File (rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#2.........:    38918 H/s (508.52ms) @ Accel:1 Loops:999 Thr:512 Vec:1
Recovered........: 1/1 (100.00%) Digests
Progress.........: 4505600/14344384 (31.41%)
Rejected.........: 0/4505600 (0.00%)
Restore.Point....: 4485120/14344384 (31.27%)
Restore.Sub.#2...: Salt:0 Amplifier:0-1 Iteration:0-999
Candidates.#2....: purd666 -> pu960414

Started: Sat Apr  4 14:47:05 2020
Stopped: Sat Apr  4 14:49:07 2020
```

That it's password is `pugh1948`. We again, get another .zip: `do_it_again.zip`. Repeating...

```bash
$zip2$*0*1*0*ae2ffd99a757380c*6f75*230*570b5576382ac4ee729869ec74f0675701fff0367c48206f3aa411219e46231903b0cd486c35889fe928010941072a16462a8137101137b68e9247c273412c6adf19e5b08351443a5be289ca71ef7536e1056151aace46f45fc9e3d0fb44468aa2d5096095da54778fad4682ff702964340b4f91dd913f8e7b94e749bec2a1cbced5f598c83324322480c5152815faecfd3bcd1913ed72fb01f64b0e8fb2f77518b2458907b5d71a014815161b532f4fb0a6f2169d2f106df2aa6e0eb0feff8909dd5199d1a911f15a9e5a630cb4f3e770b0e85641c174da5e09af2ba466294ff623b44308658deef0f2873339700e05de5b76c01089215895ebafb5415d1ebdaeea4d94207a83ac7ebb99dd5cbee88b09462a6a51d6f32305a66537d38267b935584c41649089bbdfa99b37e7c076deb207079fa2951c28ee5ec9a1cf7d3b88cf9e791d162f69478e30cbb8eafe806ed4d9dafbec8490385ac309dbdf669639f0ffe2a840d54e81cccc1d531dbaf903cdc7816798c08f3cc826cf1e955d9a920f0377e28ee90c874d4a82bcb7c18222c628858f3631d046b2c5a9a0293d7d29fd49b8b47311c6e082a696cae44d8d2fae7a7a0b448a63372cdce69b1eb625496be88920debf7e5e3f8ffc25791a2128be57a500c9d11e9afad5a3a035be1df39bb0d57d810f3d4e9c09301c7cc63a486eb3816e1e1e9806a83b0bf53985e2d7e820909156d2ebf9c5913b576c5939ab6fefec887c82829928a0d116e549810faa1945c843178eebf0fb19eecba1afa4*50024020cb946c68da65*$/zip2$:cobra0

Session..........: hashcat
Status...........: Cracked
Hash.Name........: WinZip
Hash.Target......: $zip2$*0*1*0*ae2ffd99a757380c*6f75*230*570b5576382a.../zip2$
Time.Started.....: Sat Apr  4 14:54:17 2020 (23 secs)
Time.Estimated...: Sat Apr  4 14:54:40 2020 (0 secs)
Guess.Base.......: File (rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#2.........:    43306 H/s (434.52ms) @ Accel:1 Loops:999 Thr:512 Vec:1
Recovered........: 1/1 (100.00%) Digests
Progress.........: 1003520/14344384 (7.00%)
Rejected.........: 0/1003520 (0.00%)
Restore.Point....: 983040/14344384 (6.85%)
Restore.Sub.#2...: Salt:0 Amplifier:0-1 Iteration:0-999
Candidates.#2....: computer84 -> bowwow777

Started: Sat Apr  4 14:54:13 2020
Stopped: Sat Apr  4 14:54:42 2020
```

We get `cobra0` for this one. And, we are treated with another: `again.zip`.

```bash
$zip2$*0*1*0*12d4fedf3d2ab11c*a4dc*1a0*6fa5cd4ec94d6feb2fd47a2ecd78bdce51a2881f4b061ccc45f49dc8d5bf7811cfd15a985a9c51cf033e06eb20db34fe62754b7c1e820d4858e32f1451fcee21e7cfe277501844ea8748dc3b3cf0dc4c776b27f3c9f13cab651a51519756e38fb34b95c1da951f8d01a831127caef0a1f9cddef266ac7749087fe459690a96c08e80b722c0d735dc2ee5d7091ace57003c0cc3eb92785fcae2ae04c4b98dc9bdbf536a48af707cf1e8fd45588ab95f51841304f939564b3cf6db252f4f40c07573381e8d84dd5019421b48a33e547fb4d59be0b54551eb14ce357b9c013f474e1aba19b4a688cbf5a0e9aa91cf9353987de94f7a3985a2cc15a39d2eb3bf2fad914f95392fb5562073fd10f776026900a636ee0bbb24980e263e366589c2a4bfeb67949704fb9d45bbb37f3805b17db4eb1e3780bedf7e1470e49facc3d28ff9c713b5cfefd2b53158bf5e8fce151aab87354b5b42bc5b4b74c1af2f22c273bef0ebb81ffb792a4dd8de66b48dcdb384a4d511d8071b52db8522d776b3bf0fc50573207175f914bbfe42b0923750d543300beae587d8edc2666718f20fff6098*78d0db61383020db7cfc*$/zip2$:madboy99

Session..........: hashcat
Status...........: Cracked
Hash.Name........: WinZip
Hash.Target......: $zip2$*0*1*0*12d4fedf3d2ab11c*a4dc*1a0*6fa5cd4ec94d.../zip2$
Time.Started.....: Sat Apr  4 14:56:08 2020 (2 mins, 35 secs)
Time.Estimated...: Sat Apr  4 14:58:43 2020 (0 secs)
Guess.Base.......: File (rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#2.........:    38167 H/s (501.04ms) @ Accel:1 Loops:999 Thr:512 Vec:1
Recovered........: 1/1 (100.00%) Digests
Progress.........: 5918720/14344384 (41.26%)
Rejected.........: 0/5918720 (0.00%)
Restore.Point....: 5898240/14344384 (41.12%)
Restore.Sub.#2...: Salt:0 Amplifier:0-1 Iteration:0-999
Candidates.#2....: madrsa -> mac1713

Started: Sat Apr  4 14:56:05 2020
Stopped: Sat Apr  4 14:58:44 2020
```

This one's password is `madboy99`. We get another: `keep_going.zip`. (Results left out for brevity from here out, but all cracks were on average with above runs)

```bash
$zip2$*0*1*0*110eb713b911b20c*63d3*10f*3beec4181a6498dab31d644e37b61485efd4c6dae04f06d410426b8a5940103fc38e5b437bb5b3771bf59dde9be90bffe6bae8885444adeed7bfe6301428d3add892724b377353f02278213ea036129622414a86cada04aa4ccaf25d4e9466a549af5ac51e42a5c6d87c237a85df5bfc18116d8add249e94fcc9696695d190197330b1c2cb882b0a930cdec16c7138ba8f11f97f4431e77e4397bd43f145a46ae530e83171e7eca46ad7cbc781aab113234f1cb6400b8270c117e726ec5dd1e7b00772112a24710294f30a4d78e2d760eadde1de9f0cce71de38a48328692ec06885df7a650bf514e221b1019ac52553ed3cfd47958febcc170e2307b1dae9bbbb7f257d782541cd3ea4b424b0ec24*5823b2e73bd24c201155*$/zip2$:racoon211
```

So we got `racoon211`. We get: `almost_there.zip`:

```bash
$zip2$*0*1*0*4217398c40ed3f60*b02b*8a*1e9f1e65e6919cb1b5981cd64d60bc6a7d2c13e93273cac605834debdc91c98c51598963068286654ac90061e45ea0170b372fdcfa109fb0fa40059e2fd58282fa3f6f86a48843686f16765198bb8cfbe81c661dc7fcaf346044e76b8caa68db268d672955416a91b54af60e638dff6036d2ae10d1d98767b9456474fa155bd30e0d3bf4001dea6c8b56*799a17eb83d71fbf5a1f*$/zip2$:imverygoooooooooooooooooooooooooooooooooooooooooooooooo
```

So we got `imverygoooooooooooooooooooooooooooooooooooooooooooooooo`. We now get: `nice.zip`:

```bash
$zip2$*0*1*0*b5cf82153b52a9f2*f7e1*f*9a10d111389e3e10fe274a106f0cde*73c690d9cae134d09ecc*$/zip2$:LEFTEYE
```

So we got `LEFTEYE`. Which unzipping nice.zip, gives us, AT LAST, `flag.txt`:

```bash
cat flag.txt
y0ud1d17#15789
```


# Crypto
## Pretty Ridiculous
> Eve discovered that a piece of paper had been shoved into her pocket.. what could it be? The message she found can be downloaded at the following link:
>
> (n,e) = (627585038806247, 65537)
>
> https://drive.google.com/file/d/17z7C5i_TOx_838QNPbZvNCKW4DcPCaEF/view?usp=sharing
>
> Author: c

So the file to download is a cipher text:

```python
[145213650433152, 4562349440334, 24272724667960, 598242834066721, 89584939111364, 426756492371444, 511701778613016, 551732685650248, 296367799892003, 63113462897284, 198510931603899, 321201931522255, 401044612595398, 542697603423052, 213898535689643, 275839755798105, 185841409622217, 551732685650248, 121188708737752, 401044612595398, 512808963720303, 275839755798105, 198510931603899, 275839755798105, 401044612595398, 174484844253615, 551732685650248, 174486913717420, 575163265381617, 213898535689643, 401044612595398, 49103824223436, 551732685650248, 401044612595398, 598242834066721, 202722428784490, 306606077829794, 53801100921263, 401044612595398, 184805755675232, 405971446461049, 296367799892003, 275839755798105, 275839755798105, 401044612595398, 358054299396778, 4562349440334, 320837325468842, 401044612595398, 202722428784490, 551732685650248, 321201931522255, 228350651363859]
```

We're given `n` and `e`. N is able to be easily factorized (e.g using [Wolfram Alpha](https://www.wolframalpha.com/input/?i=factorize+627585038806247)), so we also know `p` and `q`. We can use the Extended Euclidean Algorithm to find `d`, the private exponent. Once we have that, we can easily decrpypt the cipher text. [This code](https://crypto.stackexchange.com/a/68732) slightly modified with a loop for the ciphertext cracks it in less than a second:

```python
#!/usr/bin/env python3
import math

message = [145213650433152, 4562349440334, 24272724667960, 598242834066721, 89584939111364, 426756492371444, 511701778613016, 551732685650248, 296367799892003, 63113462897284, 198510931603899, 321201931522255, 401044612595398, 542697603423052, 213898535689643, 275839755798105, 185841409622217, 551732685650248, 121188708737752, 401044612595398, 512808963720303, 275839755798105, 198510931603899, 275839755798105, 401044612595398, 174484844253615, 551732685650248, 174486913717420, 575163265381617, 213898535689643, 401044612595398, 49103824223436, 551732685650248, 401044612595398, 598242834066721, 202722428784490, 306606077829794, 53801100921263, 401044612595398, 184805755675232, 405971446461049, 296367799892003, 275839755798105, 275839755798105, 401044612595398, 358054299396778, 4562349440334, 320837325468842, 401044612595398, 202722428784490, 551732685650248, 321201931522255, 228350651363859]

def getModInverse(a, m):
    if math.gcd(a, m) != 1:
        return None
    u1, u2, u3 = 1, 0, a
    v1, v2, v3 = 0, 1, m

    while v3 != 0:
        q = u3 // v3
        v1, v2, v3, u1, u2, u3 = (
            u1 - q * v1), (u2 - q * v2), (u3 - q * v3), v1, v2, v3
    return u1 % m

def main():
    # n factorized w/Wolfram Alpha gives: 13458281 x 46631887
    n = 627585038806247
    e = 65537
    p = 13458281
    q = 46631887

    # Compute phi(n)
    phi = (p - 1) * (q - 1)

    # Compute modular inverse of e
    d = getModInverse(e, phi)

    for ct in message:
        # Decrypt ciphertext
        pt = pow(ct, d, n)
        print(chr(pt), end='')
    print()
if __name__ == "__main__":
    main()
```

Running it, we get the flag. Flag is `auctf{R34lLy_Pr1M3s_w1L1_n3vEr_b3_thI5_Sm411_BuT_h3y}`.

## Land Locked
> Eve found this in one of the packets she sniffed. What does it say?
>
> `YXVjdGZ7NExMX3kwVXJfQjQ1M19SX2IzbDBOZ18yX3VTXzEyNGRmMnNkYXN2fQ==`
>
> Author: c

Clearly looks like a base64 encrypted string.

```bash
echo YXVjdGZ7NExMX3kwVXJfQjQ1M19SX2IzbDBOZ18yX3VTXzEyNGRmMnNkYXN2fQ== | base64 -d
auctf{4LL_y0Ur_B453_R_b3l0Ng_2_uS_124df2sdasv}
```

Flag is `auctf{4LL_y0Ur_B453_R_b3l0Ng_2_uS_124df2sdasv}`.

## I'll Have The Salad
> Bob and Alice love to go to the local farmer's market to get their groceries. You could call them regulars. They know the farmers so well that they've started sharing secret messages with them. Here's one of the messages they wrote to one lettuce farmer.
>
> `vpxoa{eP5o_4_R4mH_pK_1_4421_9952}`
>
> Author: c

So this looks like a rotation cipher. Again, we can use Cyberchef:

&nbsp;
{{< image src="/img/auctf/ill_have_the_salad.png" alt="ill_have_the_salad.png" position="center" style="border-radius: 8px;" >}}
&nbsp;

Flag is: `auctf{jU5t_4_W4rM_uP_1_4421_9952}`.

# Trivia
## Password 1
>
> A more secure way to hashing a password involves appending this to the password before the hashing is done.
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> Author: FireKing

Flag is `salt`.

## Networking 1
> What is Layer 7 of the OSI Model?
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> Author: Kensocolo

Flag is `Application`.

## Networking 2
> What protocol dynamically allocates IP Addresses?
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> Author: Kensocolo

Flag is `dhcp`.

## Pwn 2

> What are the pieces of a rop chain called?
>
> Author: nadrojsk

Flag is `gadget`.

## Networking 3
> What type of packet does ping use?
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> Author: kensocolo

Flag is `icmp`.

## Reversing 2
> What is the deliberate act of trying to make code unreadable by a human in order to prevent tampering and to help ensure security?
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> Author: FireKing

Flag is `encryption`

## Reversing 2
> What is the deliberate act of trying to make code unreadable by a human in order to prevent tampering and to help ensure security?
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> Author: FireKing

Flag is `obfuscation`.

## Pwn
> What is a countermeasure used to prevent return oriented programming?
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> Author: nadrojisk

Flag is `aslr`.

## OSINT 1
> What President is responsible for the agency that OSINT originated from? (First and Last name)
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> Author: FireKing

Flag is `Franklin Roosevelt`

## Web 1
> These properties are important to guarantee valid transactions within a database?
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> flag format - list all properties in comma separated list 1, 2, 3,...
>
> Author: FireKing

Flag is `atomicity, consistency, isolation, durability`.

## Networking 4
> What is the range of usable IP addresses with the following: 110.24.52.32/19
>
> NOTE: The flag is NOT in the standard auctf{} format. Enter as first IP - last IP. For example, 192.168.3.1 - 192.168.3.255
>
> Author: Kensocolo

[IP subnet calculator](https://www.calculator.net/ip-subnet-calculator.html?cclass=any&csubnet=19&cip=110.24.52.32&ctype=ipv4&printit=0&x=122&y=12).

Flag is `110.24.32.1 - 110.24.63.254`.

## Web 2
> This web attack takes advantage of web applications that can perform actions input by trusted users without requiring any form of authorization from the user allowing an attacker to perform actions through another user.
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> Author: FireKing

Flag is `Cross-site request forgery`

## Password 2
> What company fell victim to the largest known breach in history? What year was the full extent of the breach discovered?
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> flag format - company:year
>
> Author: FireKing

[Whoops -- 3 billion people is like... ALOT](https://en.wikipedia.org/wiki/Yahoo!_data_breaches#August_2013_breach).

Flag is `Yahoo!:2017`.

## Reversing 1
> What person is credited with creating the first assembler and what device was it used in?
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> flag format - person:device
>
> Author: FireKing

Flag is `David Wheeler:Electronic delay storage automatic calculator`.

## OSINT 2
> Although most federal agencies are involved in OSINT collection there is one federal agency that is the focal point for the exploitation of open source material. They primarily provide information to important government figures. Also what year was it founded?
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> flag format - agency:year
>
> Author: FireKing

Flag is `DNI Open Source Center:2005`

## Forensics 1
> Who developed the compression algorithm used to compress Debian's initrdfs image?
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> Author: FireKing

[Debian page on initrd](https://wiki.debian.org/Initrd) specifies that it expects a (compressed) cpio archive. [Wikipedia](https://en.wikipedia.org/wiki/Cpio) for cpio shows the Organiztion.

Flag is `AT&T Bell Laboratories`.


# Bash
## BASH 1
> SSH into the server
>
> ssh challenges.auctf.com -p 30040 -l level1
>
> password: aubie
>
> Author: shinigami

SSH to that box, and look at files:

```bash
$ ls
README
$ cat README
auctf{W3lcoM3_2_da_C7F}
```

Flag is `auctf{W3lcoM3_2_da_C7F}`.

## BASH 2
> ssh challenges.auctf.com -p 30040 -l level2
>
> password is the flag of the previous Bash challenge
>
> Author: shinigami

Password of previous challenge was `auctf{W3lcoM3_2_da_C7F}`; we use that to SSH to the box, and also to `sudo` on the box. We're greeted with a flag.txt we can't access as it's owned by another level, but a script we can execute.

```bash
level2@0eac6d832fac:~$ ls -alrt
-r-xr-x--- 1 level3 level2  110 Apr  1 21:25 random_dirs.sh
-r--r----- 1 level3 level3   22 Apr  1 21:25 flag.txt

level2@0eac6d832fac:~$ id
uid=1001(level2) gid=1001(level2) groups=1001(level2)

level2@0eac6d832fac:~$ cat random_dirs.sh
#!/bin/bash

x=$RANDOM

base64 flag.txt > /tmp/$x
function finish {
	rm  /tmp/$x
}
trap finish EXIT

sleep 15
```

So `random_dirs` will run generate a random number and then base64 encrypt the flag file, redirected to that random number as a file under /tmp. It then deletes it after 15 seconds.

So, if we run the script as level2, it will just give us **Permission Denied** as we can't access the flag (so we can't base64 it). We know the sudo password, so we can check what we can do with sudo:

```bash
level2@0eac6d832fac:~$ sudo -l
Matching Defaults entries for level2 on 0eac6d832fac:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User level2 may run the following commands on 0eac6d832fac:
    (level3) NOPASSWD: /home/level2/random_dirs.sh
```

And looky-looky! We can use sudo to run the script as level3 without it's password!

```bash
level2@0eac6d832fac:~$ sudo -u level3 /home/level2/random_dirs.sh
<sits for 15 seconds>
level2@0eac6d832fac:~$
```


If we access the new temp file in a separate window before it is deleted:

```bash
level2@0eac6d832fac:/tmp$ echo YXVjdGZ7ZzB0dEBfbXV2X2Zhczd9Cg== | base64 -d
auctf{g0tt@_muv_fas7}
```

Boom! Flag is `auctf{g0tt@_muv_fas7}`.

## BASH 3
> ssh challenges.auctf.com -p 30040 -l level3
>
> password is the flag to the previous Bash challenge
>
> Author: shinigami

Again, we have another script and file we can't cat as ourselves:

```bash
level3@5a2276bbe718:~$ ls -alrt
-r-xr-x--- 1 level4 level3  179 Apr  1 21:25 passcodes.sh
-r--r----- 1 level4 level4   30 Apr  1 21:25 flag.txt
```

Checking sudo rules:

```bash
level3@5a2276bbe718:~$ sudo -l
Matching Defaults entries for level3 on 5a2276bbe718:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User level3 may run the following commands on 5a2276bbe718:
    (level4) NOPASSWD: /home/level3/passcodes.sh
```

So we can `sudo -u level 4 <script>` again. Looking at the script:

```bash
level3@5a2276bbe718:~$ cat passcodes.sh
#!/bin/bash

x=$RANDOM
echo "Input the random number."
read input

if [[ "$input" -eq "$x" ]]
then
	echo "AWESOME sauce"
	cat flag.txt
else
	echo "$input"
	echo "$x try again"
fi
```

So there's a "Random" number we need to guess in order to get the flag output. We can brute force this easily, by just hardcoded a number within the `$RANDOM` function's range, and then running until we happen to match:

```bash
while true; do sudo -u level4 /home/level3/passcodes.sh < /tmp/.lul | grep -A1 AWES && break; done
AWESOME sauce
auctf{wut_r_d33z_RaNdom_numz}
```

(I sped this up by doing it in about 15 windows at once; came across the password in less than 30 seconds)

Flag is `auctf{wut_r_d33z_RaNdom_numz}`.

## BASH 4
> ssh challenges.auctf.com -p 30040 -l level4

On the box:

```bash
level4@5a2276bbe718:~$ ls -alrt
-r-xr-x--- 1 level5 level4  209 Apr  1 21:25 print_file.sh
-r--r----- 1 level5 level5   25 Apr  1 21:25 flag.txt

level4@5a2276bbe718:~$ sudo -l
Matching Defaults entries for level4 on 5a2276bbe718:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User level4 may run the following commands on 5a2276bbe718:
    (level5) NOPASSWD: /home/level4/print_file.sh

level4@5a2276bbe718:~$ sudo -u level5 ./print_file.sh flag.txt
auctf{FunKy_P3rm1ssi0nZ}
```

Wow... that was easy. Flag is `auctf{FunKy_P3rm1ssi0nZ}`


# Web
## Miyazaki Trivia
> http://challenges.auctf.com:30020
>
> Here's a bit of trivia for you vidya game nerds.
>
> Author: shinigami

If we go to this web page:

&nbsp;
{{< image src="/img/auctf/web/trivia_home.png" alt="trivia_home.png" position="center" style="border-radius: 8px;" >}}
&nbsp;

If we use dirsearch, we can see that we are able to hit the /robots.txt:

```bash
python3 dirsearch.py -u http://challenges.auctf.com:30020 -e default

 _|. _ _  _  _  _ _|_    v0.3.9
(_||| _) (/_(_|| (_| )

Extensions: default | HTTP method: get | Threads: 10 | Wordlist size: 6122

Error Log: /Users/georgepickering/Downloads/github/dirsearch/logs/errors-20-04-03_13-52-01.log

Target: http://challenges.auctf.com:30020

[13:52:18] Starting:
[13:52:29] 403 -  309B  - /.ht_wsr.txt
[13:52:29] 403 -  302B  - /.hta
[13:52:29] 403 -  311B  - /.htaccess-dev
[13:52:29] 403 -  313B  - /.htaccess-local
[13:52:29] 403 -  313B  - /.htaccess-marco
[13:52:29] 403 -  311B  - /.htaccess.BAK
[13:52:29] 403 -  312B  - /.htaccess.bak1
[13:52:29] 403 -  311B  - /.htaccess.old
[13:52:29] 403 -  312B  - /.htaccess.orig
[13:52:29] 403 -  314B  - /.htaccess.sample
[13:52:29] 403 -  312B  - /.htaccess.save
[13:52:29] 403 -  311B  - /.htaccess.txt
[13:52:29] 403 -  313B  - /.htaccess_extra
[13:52:29] 403 -  312B  - /.htaccess_orig
[13:52:29] 403 -  310B  - /.htaccess_sc
[13:52:29] 403 -  310B  - /.htaccessBAK
[13:52:29] 403 -  310B  - /.htaccessOLD
[13:52:29] 403 -  311B  - /.htaccessOLD2
[13:52:29] 403 -  308B  - /.htaccess~
[13:52:29] 403 -  311B  - /.htpasswd-old
[13:52:29] 403 -  312B  - /.htpasswd_test
[13:52:29] 403 -  308B  - /.htpasswds
[13:52:29] 403 -  306B  - /.htusers
[13:52:41] 403 -  306B  - /.htgroup
[13:52:51] 403 -  367B  - /COPYING
[13:52:59] 403 -  377B  - /faq_admin.default
[13:52:59] 403 -  364B  - /faqs
[13:53:04] 200 -  104B  - /index.html
[13:53:04] 403 -  369B  - /java-sys/
[13:53:07] 403 -  377B  - /native_stdout.log
[13:53:07] 403 -  377B  - /native_stderr.log
[13:53:12] 200 -  146B  - /robots.txt
[13:53:13] 403 -  311B  - /server-status
[13:53:13] 403 -  312B  - /server-status/
[13:53:20] 403 -  370B  - /site_admin

Task Completed
```

If we access `/robots.txt`:

&nbsp;
{{< image src="/img/auctf/web/trivia_robots.png" alt="trivia_robots.png" position="center" style="border-radius: 8px;" >}}
&nbsp;

`VIDEO GAME TRIVIA: What is the adage of Byrgenwerth scholars? MAKE a GET request to this page with a header named 'answer' to submit your answer.`

So we can answer using the following:

```bash
curl -XGET -H "answer: Fear the Old Blood" http://challenges.auctf.com:30020/robots.txt
Master Willem was right.auctf{f3ar_z_olD3_8l0oD}
```

Flag is `auctf{f3ar_z_olD3_8l0oD}`.

# Signals
## FCC Hunter

> The flag is the frequency used by Auburn University's Tiger Transit system for their radios in each bus. This will also test your OSINT skills.
>
> Flag format: auctf{xxx.xxx} where each "x" is a digit.
>
> Author: JohnsonJangler

Doing a google search for "Auburn Tiger Transit radio frequency" leads us [here](https://www.radioreference.com/apps/db/?ctid=41):


&nbsp;
{{< image src="/img/auctf/tiger_radio.png" alt="tiger_radio.png" position="center" style="border-radius: 8px;" >}}
&nbsp;

Flag is `auctf{462.025}`

# Reversing

## Sora
> This obnoxious kid with spiky hair keeps telling me his key can open all doors.
>
> Can you generate a key to open this program before he does?
>
> Connect to challenges.auctf.com 30004
>
> Author: nadrojisk

We can examine the given binary using Cutter. The important part looks to be the following:

&nbsp;
{{< image src="/img/auctf/sora_dump.png" alt="sora_dump.png" position="center" style="border-radius: 8px;" >}}
&nbsp;

So we can see that some logic is applied against our input and checked against `_secret`, and if we get the whole thing to match, we get the flag.

We can look at `_secret`'s value in cutter as well:

&nbsp;
{{< image src="/img/auctf/sora_secret.png" alt="sora_secret.png" position="center" style="border-radius: 8px;" >}}
&nbsp;

So we know secret is `aQLpavpKQcCVpfcg`. We can brute force the expected input by working backwards from this string, and the given logic:

```python
#!/usr/bin/env python3
import string

from pwn import *

index=0
secret="aQLpavpKQcCVpfcg"
for r in range(len(secret)-1):
    for c in range (0x20, 0x7E - 0x20):
        val = chr((c*8 + 0x13) % 0x3d + 0x41)
        if val == secret[index]:
            print(chr(c), end='')
            index += 1
            break
print()
```

Which if we run, gives us:

```bash
./sora_brute.py
75<"72"%5($."0(
```

Running it against the server gives us the flag:

```bash
nc challenges.auctf.com 30004
Give me a key!
75<"72"%5($."0(G
auctf{that_w@s_2_ezy_29302}
```

Flag is `auctf{that_w@s_2_ezy_29302}`.

## Mr. Game and Watch
> My friend is learning some wacky new interpreted language and different hashing algorithms. He's hidden a flag inside this program but I cant find it...
>
> He told me to connect to challenges.auctf.com 30001 once I figured it out though.
>
> Author: nadrojisk

[Decompiled using javadecompilers](http://www.javadecompilers.com/):

```java
import java.security.MessageDigest;
import java.io.IOException;
import java.io.Reader;
import java.io.BufferedReader;
import java.io.FileReader;
import java.util.Arrays;
import java.util.Scanner;

//
// Decompiled by Procyon v0.5.36
//

public class mr_game_and_watch
{
    public static String secret_1;
    public static int[] secret_2;
    public static int[] secret_3;
    public static int key_2;
    public static int key_3;

    public static void main(final String[] array) {
        System.out.println("Welcome to the Land of Interpreted Languages!");
        System.out.println("If you are used to doing compiled languages this might be a shock... but if you hate assembly this is the place to be!");
        System.out.println("\nUnfortunately, if you hate Java, this may suck...");
        System.out.println("Good luck!\n");
        if (crackme()) {
            print_flag();
        }
    }

    private static boolean crackme() {
        final Scanner scanner = new Scanner(System.in);
        if (crack_1(scanner) && crack_2(scanner) && crack_3(scanner)) {
            System.out.println("That's correct!");
            scanner.close();
            return true;
        }
        System.out.println("Nope that's not right!");
        scanner.close();
        return false;
    }

    private static boolean crack_1(final Scanner scanner) {
        System.out.println("Let's try some hash cracking!! I'll go easy on you the first time. The first hash we are checking is this");
        System.out.println(invokedynamic(makeConcatWithConstants:(Ljava/lang/String;)Ljava/lang/String;, mr_game_and_watch.secret_1));
        System.out.print("Think you can crack it? If so give me the value that hashes to that!\n\t");
        return hash(scanner.nextLine(), "MD5").compareTo(mr_game_and_watch.secret_1) == 0;
    }

    private static boolean crack_2(final Scanner scanner) {
        System.out.println("Nice work! One down, two to go ...");
        System.out.print("This next one you don't get to see, if you aren't already digging into the class file you may wanna try that out!\n\t");
        return hash(scanner.nextLine(), "SHA1").compareTo(decrypt(mr_game_and_watch.secret_2, mr_game_and_watch.key_2)) == 0;
    }

    private static boolean crack_3(final Scanner scanner) {
        System.out.print("Nice work! Here's the last one...\n\t");
        return Arrays.equals(encrypt(hash(scanner.nextLine(), "SHA-256"), mr_game_and_watch.key_3), mr_game_and_watch.secret_3);
    }

    private static int[] encrypt(final String s, final int n) {
        final int[] array = new int[s.length()];
        for (int i = 0; i < s.length(); ++i) {
            array[i] = (s.charAt(i) ^ n);
        }
        return array;
    }

    private static String decrypt(final int[] array, final int n) {
        String s = "";
        for (int i = 0; i < array.length; ++i) {
            s = invokedynamic(makeConcatWithConstants:(Ljava/lang/String;C)Ljava/lang/String;, s, (char)(array[i] ^ n));
        }
        return s;
    }

    private static void print_flag() {
        final String fileName = "flag.txt";
        try {
            final BufferedReader bufferedReader = new BufferedReader(new FileReader(fileName));
            try {
                String line;
                while ((line = bufferedReader.readLine()) != null) {
                    System.out.println(line);
                }
                bufferedReader.close();
            }
            catch (Throwable t) {
                try {
                    bufferedReader.close();
                }
                catch (Throwable exception) {
                    t.addSuppressed(exception);
                }
                throw t;
            }
        }
        catch (IOException ex) {
            System.out.println("Could not find file please notify admin");
        }
    }

    public static String hash(final String s, final String algorithm) {
        String string = null;
        try {
            final byte[] digest = MessageDigest.getInstance(algorithm).digest(s.getBytes("UTF-8"));
            final StringBuilder sb = new StringBuilder(2 * digest.length);
            final byte[] array = digest;
            for (int length = array.length, i = 0; i < length; ++i) {
                sb.append(String.format("%02x", array[i] & 0xFF));
            }
            string = sb.toString();
        }
        catch (Exception ex) {
            System.out.println("broke");
        }
        return string;
    }

    static {
        mr_game_and_watch.secret_1 = "d5c67e2fc5f5f155dff8da4bdc914f41";
        mr_game_and_watch.secret_2 = new int[] { 114, 118, 116, 114, 113, 114, 36, 37, 38, 38, 120, 121, 33, 36, 37, 113, 117, 118, 118, 113, 33, 117, 121, 37, 119, 34, 118, 115, 114, 120, 119, 114, 36, 120, 117, 120, 38, 114, 35, 118 };
        mr_game_and_watch.secret_3 = new int[] { 268, 348, 347, 347, 269, 256, 348, 269, 256, 256, 344, 271, 271, 264, 266, 348, 257, 266, 267, 348, 269, 266, 266, 344, 267, 270, 267, 267, 348, 349, 349, 265, 349, 267, 256, 269, 270, 349, 268, 271, 351, 349, 347, 269, 349, 271, 257, 269, 344, 351, 265, 351, 265, 271, 346, 271, 266, 264, 351, 349, 351, 271, 266, 266 };
        mr_game_and_watch.key_2 = 64;
        mr_game_and_watch.key_3 = 313;
    }
}
```

If we run the given `.class` file:

```bash
java mr_game_and_watch
Welcome to the Land of Interpreted Languages!
If you are used to doing compiled languages this might be a shock... but if you hate assembly this is the place to be!

Unfortunately, if you hate Java, this may suck...
Good luck!

Let's try some hash cracking!! I'll go easy on you the first time. The first hash we are checking is this
	d5c67e2fc5f5f155dff8da4bdc914f41
Think you can crack it? If so give me the value that hashes to that!

```

We can look this up easily online, and see that that hash is an MD5 hash for `masterchief`.

Putting that in:

```bash
...
Think you can crack it? If so give me the value that hashes to that!
	masterchief
Nice work! One down, two to go ...
This next one you don't get to see, if you aren't already digging into the class file you may wanna try that out!

```

So we know the second secret, by examining the `decrypt()` function, and the `mr_game_and_watch.secret_2` and `mr_game_and_watch.key_2` variables from the dump above. I pasted them into Python to solve:

```python
>>> mr_game_watch_2=[114, 118, 116, 114, 113, 114, 36, 37, 38, 38, 120, 121, 33, 36, 37, 113, 117, 118, 118, 113, 33, 117, 121, 37, 119, 34, 118, 115, 114, 120, 119, 114, 36, 120, 117, 120, 38, 114, 35, 118]
>>> ''.join(list(chr(a^64) for a in mr_game_watch_2))
'264212deff89ade15661a59e7b632872d858f2c6'

```

Again, looking this up online for [SHA1 decryptors](https://md5decrypt.net/en/Sha1), we can see this is for `princesspeach`. Putting that in:

```bash
...
This next one you don't get to see, if you aren't already digging into the class file you may wanna try that out!
	princesspeach
Nice work! Here's the last one...

```

OK - and again, we can find the third secret, by examining the `crack_3()` function, and the `mr_game_and_watch.secret_3` and `mr_game_and_watch.key_3` variables from the dump above.

```java
    private static boolean crack_3(final Scanner scanner) {
        System.out.print("Nice work! Here's the last one...\n\t");
        return Arrays.equals(encrypt(hash(scanner.nextLine(), "SHA-256"), mr_game_and_watch.key_3), mr_game_and_watch.secret_3);
    }
...
    private static int[] encrypt(final String s, final int n) {
        final int[] array = new int[s.length()];
        for (int i = 0; i < s.length(); ++i) {
            array[i] = (s.charAt(i) ^ n);
        }
        return array;
    }
...
```

So it's going to encode our input using SHA-256, and then encrypt it using the 3rd key. Then, it will check if that is equal to the third secret. So, we can work backwards.

```python
>>> mr_game_watch_3=[ 268, 348, 347, 347, 269, 256, 348, 269, 256, 256, 344, 271, 271, 264, 266, 348, 257, 266, 267, 348, 269, 266, 266, 344, 267, 270, 267, 267, 348, 349, 349, 265, 349, 267, 256, 269, 270, 349, 268, 271, 351, 349, 347, 269, 349, 271, 257, 269, 344, 351, 265, 351, 265, 271, 346, 271, 266, 264, 351, 349, 351, 271, 266, 266]
>>> ''.join(list(chr(a^313) for a in mr_game_watch_3))
'5ebb49e499a6613e832e433a2722edd0d2947d56fdb4d684af0f06c631fdf633'
```

Which, looking up [online](https://md5decrypt.net/en/Sha256) shows it to be `solidsnake`. Putting that in:

```bash
...
Nice work! Here's the last one...
	solidsnake
That's correct!
Could not find file please notify admin
```

If we do that on the remote endpoint where the flag actually exists, we get the flag:

```bash
nc challenges.auctf.com 30001
Welcome to the Land of Interpreted Languages!
If you are used to doing compiled languages this might be a shock... but if you hate assembly this is the place to be!

Unfortunately, if you hate Java, this may suck...
Good luck!

Let's try some hash cracking!! I'll go easy on you the first time. The first hash we are checking is this
	d5c67e2fc5f5f155dff8da4bdc914f41
Think you can crack it? If so give me the value that hashes to that!
	masterchief
Nice work! One down, two to go ...
This next one you don't get to see, if you aren't already digging into the class file you may wanna try that out!
	princesspeach
Nice work! Here's the last one...
	solidsnake
That's correct!
auctf{If_u_h8_JAVA_and_@SM_try_c_sharp_2922}
```

Flag is `auctf{If_u_h8_JAVA_and_@SM_try_c_sharp_2922}`.

## Cracker Barrel
> I found a USB drive under the checkers board at cracker barrel. My friends told me not to plug it in but surely nothing bad is on it?
>
> I found this file, but I can't seem to unlock it's secrets. Can you help me out?
>
> Also.. once you think you've got it I think you should try to connect to challenges.auctf.com at port 30000 not sure what that means, but it written on the flash drive..
>
> Author: nadrojisk

I examined the source code for this in Cutter. The first check was:

&nbsp;
{{< image src="/img/auctf/cracker_barrel.png" alt="cracker_barrel.png" position="center" style="border-radius: 8px;" >}}
&nbsp;

Which we can pass by passing `starwars`. Then, the next two checks were:


&nbsp;
{{< image src="/img/auctf/cracker_barrel2.png" alt="cracker_barrel2.png" position="center" style="border-radius: 8px;" >}}
&nbsp;
&nbsp;
&nbsp;
{{< image src="/img/auctf/cracker_barrel3.png" alt="cracker_barrel3.png" position="center" style="border-radius: 8px;" >}}
&nbsp;

which we can pass simply by passing nothing (i.e. just empty entering both).

Connecting to the service:

```bash
nc challenges.auctf.com 30000
Give me a key!
starwars
You have passed the first test! Now I need another key!

Nice work! You've passes the second test, we aren't done yet!

Congrats you finished! Here is your flag!
auctf{w3lc0m3_to_R3_1021}
```

Flag is `auctf{w3lc0m3_to_R3_1021}`.

## mobile0
> Hey, look its an android file. Can you find the flag?
>
> https://drive.google.com/open?id=1rX6W8xC5VCmzsFLO9r5yPCFKt4LMU5sc
>
> Author: Kensocolo

Downloading that `mobile0.apk` file, and using `strings mobile0.apk | grep auc`, we see the flag.

Flag is `auctf{m0b1le_r3v3rs1ng!!}`.


## mobile1
> My friend sent this file to me and said that there was a flag in it. Can you help me?
>
> https://drive.google.com/open?id=1iglx4cQ_iVi1RABBa1eF0OXcOGECjVLy
>
> Author: kensocolo

We can download the file, `mobile1.ipa`. We can then rename the .ipa to .zip, and extract it like so. That gives us a `Payload/mobile1.app` directory, which we can see has:

```bash
tree
.
├── Base.lproj
│   ├── LaunchScreen.storyboardc
│   │   ├── 01J-lp-oVM-view-Ze5-6b-2t3.nib
│   │   ├── Info.plist
│   │   └── UIViewController-01J-lp-oVM.nib
│   └── Main.storyboardc
│       ├── BYZ-38-t0r-view-8bC-Xf-vdC.nib
│       ├── Info.plist
│       └── UIViewController-BYZ-38-t0r.nib
├── Info.plist
├── PkgInfo
├── _CodeSignature
│   └── CodeResources
└── mobile1

```

Doing a `strings Info.plist` gives us the flag:

```bash
...
EFG_
UIInterfaceOrientationPortrait_
#UIInterfaceOrientationLandscapeLeft_
$UIInterfaceOrientationLandscapeRight
EIFG_
(UIInterfaceOrientationPortraitUpsideDown_
#auctf{i0s_r3v3rs1ng_1s_1nt3r3st1ng}
```

Flag is `auctf{i0s_r3v3rs1ng_1s_1nt3r3st1ng}`

# OSINT

## Who Made Me
> One of the developers of this CTF worked really hard on this challenge.
>
> note: the answer is not the author's name
>
> Author: c

Doing a [Github search](https://github.com/search?q=auctf+2020) for "AUCTF 2020" yields us 3 results.

&nbsp;
{{< image src="/img/auctf/auctf_search_results.png" alt="auctf_search_results.png" position="center" style="border-radius: 8px;" >}}
&nbsp;

If you manually inspect all them starting from the top, we see that the first repo looks to be the actual one being used for the current competition.

The [second entry](https://github.com/vincentchu37/AUCTF-2020) has no files and an empty README, but 3 commits. Looking through the commits, we see a flag:

&nbsp;
{{< image src="/img/auctf/you_found_me.png" alt="you_found_me.png" position="center" style="border-radius: 8px;" >}}
&nbsp;

Flag is `auctf{G1tHuB_4lwAY5_r3mEmB3r5_8923_1750921}`.

# Sequence
## Prime Rib
> Time to put your problem solving skills to work! Finish the sequence!
>
> 0, 1, 1, 2, 4, 8, 6, 22, 8, 9, 10, __, __, __, __, __
>
> NOTE: The flag is NOT in the standard auctf{} format
>
> flag format - comma separated list 1, 2, 3, 4, 5
>
> Author: FireKing

No idea how to solve this one until they changed the challenge names to include hints. "Prime Rib" suggested something to deal with prime numbers. After looking at the given sequence long enough, realized that all non-prime indices' values were just their index, and every prime index was the sum of all values before it. Roughly:

```python
def is_prime(n):
    for i in range(3, n):
        if n % i == 0:
            return False
    return True

sequence = []
for i in range(16):
  if i<2 or not is_prime(i):
    sequence.append(i)
  else:
    sequence.append(sum(sequence[0:i]))
```

Gives us our sequence:

```python
[0, 1, 1, 2, 4, 8, 6, 22, 8, 9, 10, 71, 12, 154, 14, 15]
```

Flag is `71, 12, 154, 14, 15`.


